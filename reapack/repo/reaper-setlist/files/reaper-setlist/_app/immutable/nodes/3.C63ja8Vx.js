import{b as I,a as g,d as ye,f as A,g as jt,s as m,t as ke}from"../chunks/BzJ4SX3Z.js";import{o as be,a as Te}from"../chunks/BD92J0bs.js";import{p as Se,q as M,k as zt,s as o,f as R,a as Pe,c as r,o as $,l as t,m as _,r as s,t as rt,n as Me,a6 as Rt}from"../chunks/CK57Ve49.js";import{r as L,i as V}from"../chunks/_0x7LJxc.js";import{a as B,g as Fe,n as F,B as C,e as Ce,j as Y,f as Ae}from"../chunks/BL5BhTo2.js";import{P as Ie}from"../chunks/J2KatcRz.js";const st=0,at=1,Vt=2,Le=5;var Be=I('<svg><path fill="currentColor" d="M14 19h4V5h-4M6 19h4V5H6z"></path></svg>');function De(u,c){const v=L(c,["$$slots","$$events","$$legacy"]);var a=Be();B(a,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...v})),g(u,a)}var Ee=I('<svg><path fill="currentColor" d="M19 12c0 3.86-3.14 7-7 7s-7-3.14-7-7s3.14-7 7-7s7 3.14 7 7"></path></svg>');function je(u,c){const v=L(c,["$$slots","$$events","$$legacy"]);var a=Ee();B(a,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...v})),g(u,a)}var ze=I('<svg><path fill="currentColor" d="M16 18h2V6h-2M6 18l8.5-6L6 6z"></path></svg>');function Re(u,c){const v=L(c,["$$slots","$$events","$$legacy"]);var a=ze();B(a,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...v})),g(u,a)}var Ve=I('<svg><path fill="currentColor" d="M6 18V6h2v12zm3.5-6L18 6v12z"></path></svg>');function Ye(u,c){const v=L(c,["$$slots","$$events","$$legacy"]);var a=Ve();B(a,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...v})),g(u,a)}var He=I('<svg><path fill="currentColor" d="M18 18H6V6h12z"></path></svg>');function Ne(u,c){const v=L(c,["$$slots","$$events","$$legacy"]);var a=He();B(a,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...v})),g(u,a)}var Ue=A('<div class="next-song svelte-tcdq5v"><div class="next-song-name svelte-tcdq5v"> </div> <div class="next-song-duration svelte-tcdq5v"> </div></div>'),Oe=A('<div class="set-complete svelte-tcdq5v">Set Complete!</div>'),Ge=(u,c)=>c(),Je=(u,c,v)=>c(t(v)),Ke=A('<button class="marker-button svelte-tcdq5v"><div class="marker-name svelte-tcdq5v"> </div> <div class="marker-time svelte-tcdq5v"> </div></button>'),Qe=A('<div class="current-song-section svelte-tcdq5v"><div class="song-info svelte-tcdq5v"><div class="song-meta svelte-tcdq5v"><span class="song-number"> </span></div> <h2 class="song-title svelte-tcdq5v"> </h2></div> <div class="track-navigation svelte-tcdq5v"><!> <!></div> <div class="next-up-info svelte-tcdq5v"><div class="next-up-header svelte-tcdq5v"><h4 class="svelte-tcdq5v">Next Up</h4> <!></div></div></div> <div class="transport-section svelte-tcdq5v"><div class="transport-controls svelte-tcdq5v"><div class="main-controls svelte-tcdq5v"><!> <!> <!></div></div> <div class="song-progress"><div class="progress-group svelte-tcdq5v"><div class="progress-label svelte-tcdq5v"><span>Song Progress</span> <span class="time-display svelte-tcdq5v"> </span></div> <div class="progress-bar-container svelte-tcdq5v"><div class="progress-bar svelte-tcdq5v"><div class="progress-fill svelte-tcdq5v"></div> <div class="progress-handle svelte-tcdq5v"></div></div></div> <div class="remaining-time svelte-tcdq5v"> </div></div></div></div> <div class="set-section svelte-tcdq5v"><div class="set-progress"><div class="progress-group svelte-tcdq5v"><div class="progress-label svelte-tcdq5v"><span>Set Progress</span> <span class="time-display svelte-tcdq5v"> </span></div> <div class="progress-bar-container svelte-tcdq5v"><div class="progress-bar set-progress-bar svelte-tcdq5v"><div class="progress-fill svelte-tcdq5v"></div> <div class="progress-handle svelte-tcdq5v"></div></div></div> <div class="remaining-time svelte-tcdq5v"> </div></div></div></div> <div class="markers-section svelte-tcdq5v"><h3 class="svelte-tcdq5v">Song Markers</h3> <div class="markers-grid svelte-tcdq5v"><button class="marker-button svelte-tcdq5v"><div class="marker-name svelte-tcdq5v">Start</div> <div class="marker-time svelte-tcdq5v"> </div></button> <!></div></div>',1),We=A('<div class="no-setlist svelte-tcdq5v"><h2 class="svelte-tcdq5v">No Setlist Loaded</h2> <p class="svelte-tcdq5v">Please load a setlist to begin playing.</p> <!></div>'),Xe=A('<meta:head><title>Player - Reaper Setlist</title></meta:head> <div class="player-container svelte-tcdq5v"><h1>Live Player</h1> <!></div>',1);function or(u,c){Se(c,!0);const v=Fe();let a=M(null),l=M(0),w=M(zt(st)),T=M(0),ot=_(()=>t(a)?t(a).slice(0,t(l)).reduce((e,i)=>e+(i.length||0),0)+t(T):0),H=M(null),N=M(null);const U=_(()=>!t(a)||t(l)<0||t(l)>=t(a).length?null:t(a)[t(l)]||null);let vt=M(zt([]));const D=_(()=>{var e;return((e=t(U))==null?void 0:e.length)||0}),Yt=_(()=>Math.max(0,t(D)-t(T))),O=_(()=>t(a)?t(a).reduce((e,i)=>e+(i.length||0),0):0),Ht=_(()=>t(a)?(()=>{let e=0;for(let i=t(l);i<t(a).length;i++){const b=t(a)[i].length||0;i===t(l)?e+=Math.max(0,b-t(T)):e+=b}return e})():0),it=_(()=>t(D)===0?0:Math.min(100,t(T)/t(D)*100)),nt=_(()=>t(O)===0?0:Math.min(100,t(ot)/t(O)*100));function y(e){const i=Math.floor(e/60),k=Math.floor(e%60);return`${i}:${k.toString().padStart(2,"0")}`}function lt(e){return e.replace(/\.[^/.]+$/,"")}async function Nt(){try{if(t(w)===at){const e=await v.reaper.pause();q(e)}else if(t(w)===Vt||t(w)===st){const e=await v.reaper.play();q(e)}}catch(e){F.error(`Failed to toggle playback: ${e.message}`)}}async function Ut(){try{const e=await v.reaper.stop();q(e)}catch(e){F.error(`Failed to stop playback: ${e.message}`)}}async function Ot(){if(t(l)>0){Rt(l,-1);const e=await v.reaper.previousTab();G(e.markers),q(e.transport)}}async function Gt(){if(t(a)&&t(l)<t(a).length-1){Rt(l);const e=await v.reaper.nextTab();G(e.markers),q(e.transport)}}async function Jt(e){try{const i=await v.reaper.goToMarker(e.id);q(i)}catch(i){F.error(`Failed to jump to marker: ${i.message}`),console.error("Failed to jump to marker:",i)}}async function Kt(){try{const e=await v.reaper.goToStart();q(e)}catch(e){F.error(`Failed to jump to song start: ${e.message}`),console.error("Failed to jump to song start:",e)}}async function Qt(){try{const e=await v.reaper.record();q(e)}catch(e){F.error(`Failed to toggle recording: ${e.message}`),console.error("Failed to toggle recording:",e)}}function q(e){e?($(w,e.playState,!0),$(T,e.positionSeconds,!0)):($(w,st,!0),$(T,0))}function G(e){$(vt,e,!0)}async function ct(){try{const e=await v.reaper.getTransport();q(e)}catch(e){console.error("Failed to update transport:",e)}}async function dt(){try{const e=await v.reaper.getMarkers();G(e)}catch(e){console.error("Failed to load markers:",e)}}async function pt(){try{const e=await v.script.getOpenTabs();(t(a)!==e.tabs||t(l)!==e.activeIndex)&&($(a,e.tabs,!0),$(l,e.activeIndex,!0),await dt()),(t(l)<0||t(l)>=t(a).length)&&$(l,0)}catch(e){console.error(`Failed to refresh tabs: ${e.message}`)}}be(async()=>{try{$(N,window.setInterval(pt,5e3),!0),$(H,window.setInterval(ct,1e3),!0),await pt(),await dt(),await ct()}catch(e){F.error(`Failed to load initial data: ${e.message}`),console.error(`Failed to load data: ${e.message}`)}}),Te(()=>{t(H)&&window.clearInterval(t(H)),t(N)&&window.clearInterval(t(N))});var gt=Xe(),ut=o(R(gt),2),Wt=o(r(ut),2);{var Xt=e=>{var i=Qe(),k=R(i),b=r(k),E=r(b),j=r(E),te=r(j);s(j),s(E);var ht=o(E,2),ee=r(ht,!0);s(ht),s(b);var J=o(b,2),_t=r(J);const re=_(()=>t(l)===0);C(_t,{variant:"icon",onclick:Ot,get disabled(){return t(re)},children:(n,d)=>{Ye(n,{})},$$slots:{default:!0}});var se=o(_t,2);const ae=_(()=>!t(a)||t(l)>=t(a).length-1);C(se,{variant:"icon",onclick:Gt,get disabled(){return t(ae)},children:(n,d)=>{Re(n,{})},$$slots:{default:!0}}),s(J);var mt=o(J,2),ft=r(mt),oe=o(r(ft),2);{var ve=n=>{var d=jt();const h=_(()=>t(a)[t(l)+1]);var x=R(d);{var S=f=>{var p=Ue(),P=r(p),$e=r(P,!0);s(P);var Et=o(P,2),we=r(Et,!0);s(Et),s(p),rt((qe,xe)=>{m($e,qe),m(we,xe)},[()=>lt(t(h).name),()=>Ae(t(h).length)]),g(f,p)};V(x,f=>{t(h)&&f(S)})}g(n,d)},ie=n=>{var d=Oe();g(n,d)};V(oe,n=>{t(l)<t(a).length-1?n(ve):n(ie,!1)})}s(ft),s(mt),s(k);var K=o(k,2),Q=r(K),$t=r(Q),wt=r($t);const ne=_(()=>t(w)===at||t(w)===Vt?"delete":"primary");C(wt,{variant:"icon",onclick:Ut,get color(){return t(ne)},children:(n,d)=>{Ne(n,{})},$$slots:{default:!0}});var qt=o(wt,2);C(qt,{variant:"icon",onclick:Nt,color:"success",children:(n,d)=>{var h=jt(),x=R(h);{var S=p=>{De(p,{})},f=p=>{Ie(p,{})};V(x,p=>{t(w)===at?p(S):p(f,!1)})}g(n,h)},$$slots:{default:!0}});var le=o(qt,2);const ce=_(()=>t(w)===Le?"delete":"primary");C(le,{variant:"icon",onclick:Qt,get color(){return t(ce)},children:(n,d)=>{je(n,{})},$$slots:{default:!0}}),s($t),s(Q);var xt=o(Q,2),yt=r(xt),W=r(yt),kt=o(r(W),2),de=r(kt);s(kt),s(W);var X=o(W,2),bt=r(X),Tt=r(bt),pe=o(Tt,2);s(bt),s(X);var St=o(X,2),ge=r(St);s(St),s(yt),s(xt),s(K);var Z=o(K,2),Pt=r(Z),Mt=r(Pt),tt=r(Mt),Ft=o(r(tt),2),ue=r(Ft);s(Ft),s(tt);var et=o(tt,2),Ct=r(et),At=r(Ct),he=o(At,2);s(Ct),s(et);var It=o(et,2),_e=r(It);s(It),s(Mt),s(Pt),s(Z);var Lt=o(Z,2),Bt=o(r(Lt),2),z=r(Bt);z.__click=[Ge,Kt];var Dt=o(r(z),2),me=r(Dt,!0);s(Dt),s(z);var fe=o(z,2);Ce(fe,17,()=>t(vt),n=>n.id,(n,d)=>{var h=Ke();h.__click=[Je,Jt,d];var x=r(h),S=r(x,!0);s(x);var f=o(x,2),p=r(f,!0);s(f),s(h),rt(P=>{m(S,t(d).name),m(p,P)},[()=>y(t(d).position)]),g(n,h)}),s(Bt),s(Lt),rt((n,d,h,x,S,f,p,P)=>{m(te,`Track ${t(l)+1} of ${t(a).length??""}`),m(ee,n),m(de,`${d??""} / ${h??""}`),Y(Tt,`width: ${t(it)??""}%`),Y(pe,`left: ${t(it)??""}%`),m(ge,`-${x??""}`),m(ue,`${S??""} / ${f??""}`),Y(At,`width: ${t(nt)??""}%`),Y(he,`left: ${t(nt)??""}%`),m(_e,`-${p??""}`),m(me,P)},[()=>lt(t(U).name),()=>y(t(T)),()=>y(t(D)),()=>y(t(Yt)),()=>y(t(ot)),()=>y(t(O)),()=>y(t(Ht)),()=>y(0)]),g(e,i)},Zt=e=>{var i=We(),k=o(r(i),4);C(k,{elementType:"a",href:"#/",color:"primary",children:(b,E)=>{Me();var j=ke("Browse Setlists");g(b,j)},$$slots:{default:!0}}),s(i),g(e,i)};V(Wt,e=>{t(a)&&t(U)?e(Xt):e(Zt,!1)})}s(ut),g(u,gt),Pe()}ye(["click"]);export{or as component};
