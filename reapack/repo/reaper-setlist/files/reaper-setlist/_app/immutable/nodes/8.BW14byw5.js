import{g as N,B as y,f as X,n as p}from"../chunks/PsnSwRbB.js";import{f as m,a as l,s as S,t as C}from"../chunks/Dktx9MQm.js";import{p as Y,k as O,s as h,f as B,a as Z,c as _,r as $,t as E,y as I,m as P,n as A,q as L}from"../chunks/Dv93RvCJ.js";import{i as M}from"../chunks/5mgx-mTD.js";import{I as ee,R as te,P as re}from"../chunks/CueYkOdy.js";import{D as oe}from"../chunks/BtOcgIR3.js";import{P as ae}from"../chunks/BZbKSdW2.js";const se=async({fetch:w})=>{try{const o=N(w),[u,c]=await Promise.all([o.songs.list(),o.script.listProjects()]);return{songs:u,projects:c}}catch(o){return{songs:{},error:o instanceof Error?o.message:"An unknown error occurred."}}},$e=Object.freeze(Object.defineProperty({__proto__:null,load:se},Symbol.toStringTag,{value:"Module"}));var ne=m('<p style="color: red;"> </p>'),ce=m('<div class="song-info svelte-1le9xyy"><span class="song-name svelte-1le9xyy"> </span> <span class="song-duration svelte-1le9xyy"> </span></div>'),le=m("<!> <!>",1),ie=m('<div class="action-section"><!> <!></div>'),de=m('<p style="color: var(--text-muted);">No Reaper projects found. Please double-check your backing tracks folder in Settings.</p>'),pe=m("<meta:head><title>Songs - Reaper Setlist</title></meta:head> <h1>Songs</h1> <!> <!>",1);function Pe(w,o){Y(o,!0);let u=O(o.data.songs),c=O(o.data.projects),k=A(()=>c?c.filter(e=>!Object.values(u).some(t=>t.path===e)):[]);const s=N(),R=o.data.error;async function q(e){try{await s.reaper.newTab(),await s.script.openProject(e.path),p.success(`${e.name} loaded successfully in Reaper!`)}catch(t){console.error("Error loading song in Reaper:",t),p.error("Failed to communicate with Reaper")}}async function z(e){if(confirm("Are you sure you want to delete this song?"))try{await s.songs.delete(e.id),delete u[e.id],s.sets.deleteSongFromSets(e.id),p.success("Song deleted successfully")}catch(t){p.error(`Failed to delete song: ${t.message}`);return}}async function G(e){var a;const t=(a=e.split("/").pop())==null?void 0:a.replace(/\.[^/.]+$/,"");await s.reaper.newTab(),await s.script.openProject(e);const r=await s.script.getProjectLength();return await s.reaper.closeTab(),await s.songs.add({name:t||e,path:e,length:r})}async function H(){if(!c||c.length===0){p.error("No Reaper projects found to add.");return}const e=[];for(const t of P(k))try{const r=await G(t);u[r.id]=r,e.push(r.name)}catch(r){console.error(`Failed to add song from project ${t}:`,r),p.error(`Failed to add song from project ${t}`)}e.length>0&&p.success(`Added songs: ${e.join(", ")}`)}function J(e,t){return e.name.localeCompare(t.name)}var F=pe(),T=h(B(F),4);{var K=e=>{var t=ne(),r=_(t,!0);$(t),E(()=>S(r,R)),l(e,t)},Q=e=>{{const t=(a,n=I)=>{var i=ce(),f=_(i),g=_(f,!0);$(f);var d=h(f,2),v=_(d,!0);$(d),$(i),E(b=>{S(g,n().name),S(v,b)},[()=>X(n().length)]),l(a,i)},r=(a,n=I)=>{te(a,{primaryAction:g=>{y(g,{color:"primary",onclick:()=>q(n()),variant:"icon",children:(d,v)=>{ae(d,{})},$$slots:{default:!0}})},secondaryActions:g=>{var d=le(),v=B(d);{let x=A(()=>`#/song/${n().id}/edit`);y(v,{elementType:"a",color:"edit",get href(){return P(x)},variant:"icon",children:(D,ue)=>{re(D,{})},$$slots:{default:!0}})}var b=h(v,2);y(b,{color:"delete",onclick:()=>z(n()),variant:"icon",children:(x,D)=>{oe(x,{})},$$slots:{default:!0}}),l(g,d)},$$slots:{primaryAction:!0,secondaryActions:!0}})};let j=A(()=>Object.values(u).toSorted(J));ee(e,{get items(){return P(j)},nameDisplay:t,actions:r,$$slots:{nameDisplay:!0,actions:!0}})}};M(T,e=>{R?e(K):e(Q,!1)})}var U=h(T,2);{var V=e=>{var t=ie(),r=_(t);y(r,{elementType:"a",href:"#/song/add",color:"success",children:(a,n)=>{L();var i=C("Add Song");l(a,i)},$$slots:{default:!0}});var j=h(r,2);{let a=A(()=>P(k).length===0);y(j,{elementType:"button",get disabled(){return P(a)},onclick:H,color:"success",children:(n,i)=>{L();var f=C("Add All");l(n,f)},$$slots:{default:!0}})}$(t),l(e,t)},W=e=>{var t=de();l(e,t)};M(U,e=>{c&&c.length>0?e(V):e(W,!1)})}l(w,F),Z()}export{Pe as component,$e as universal};
