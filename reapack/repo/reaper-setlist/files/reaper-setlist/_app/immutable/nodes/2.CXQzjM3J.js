import{g as z,a as W,n as w,B as P,f as X}from"../chunks/DEfdFb_i.js";import{b as Z,a as i,f as h,s as S,t as ee}from"../chunks/B_oGNvez.js";import{o as te}from"../chunks/D9zGA_ww.js";import{p as ae,k as se,s as g,f as B,a as re,c as n,r as l,t as H,y as R,m as T,n as j,q as oe}from"../chunks/BWSO7Bi6.js";import{r as ne,i as V}from"../chunks/DnK7exoB.js";import{I as le,R as ie,P as ce}from"../chunks/6avop1Mg.js";import{D as de}from"../chunks/ZPwupsfc.js";import{P as ue}from"../chunks/BKTy_5NM.js";const ve=async({fetch:_})=>{try{const s=z(_),[c,d]=await Promise.all([s.sets.list(),s.songs.list()]);return{sets:c,songs:d}}catch(s){return console.error("Error loading sets and songs:",s),{sets:{},songs:{},error:s instanceof Error?s.message:"An unknown error occurred."}}},Ce=Object.freeze(Object.defineProperty({__proto__:null,load:ve},Symbol.toStringTag,{value:"Module"}));var pe=Z('<svg><path fill="currentColor" d="M19 21H8V7h11m0-2H8a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2m-3-4H4a2 2 0 0 0-2 2v14h2V3h12z"></path></svg>');function ge(_,s){const c=ne(s,["$$slots","$$events","$$legacy"]);var d=pe();W(d,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...c})),i(_,d)}var fe=h('<p style="color: red;"> </p>'),me=h('<div class="set-info svelte-1uha8ag"><div class="set-header svelte-1uha8ag"><span class="date svelte-1uha8ag"> </span> <span class="venue svelte-1uha8ag"> </span></div> <div class="set-details svelte-1uha8ag"><span class="song-count svelte-1uha8ag"> </span> <span class="duration svelte-1uha8ag"> </span></div></div>'),he=h("<!> <!> <!>",1),_e=h('<div class="action-section"><!></div>'),ye=h('<p style="color: var(--text-muted);">No songs available. Please add some songs to get started.</p>'),$e=h("<meta:head><title>Sets - Reaper Setlist</title></meta:head> <h1>Sets</h1> <!> <!>",1);function Fe(_,s){ae(s,!0);const c=se(s.data.sets),d=s.data.songs,A=s.data.error,M=z();te(()=>{A&&w.error(`Failed to load data: ${A}`)});async function E(e){if(confirm("Are you sure you want to delete this set?"))try{await M.sets.delete(e.id),delete c[e.id],w.success("Set deleted successfully")}catch(t){w.error(`Failed to delete set: ${t.message}`)}}async function I(e){const t={...e,id:void 0,venue:`${e.venue} (copy)`};try{const r=await M.sets.add(t);c[r.id]=r,w.success("Set duplicated successfully")}catch(r){w.error(`Failed to duplicate set: ${r.message}`)}}function L(e,t){return e.date!==t.date?new Date(e.date).getTime()-new Date(t.date).getTime():e.venue!==t.venue?e.venue.localeCompare(t.venue):e.id.localeCompare(t.id)}function q(e){const t=new Date(e),r=new Date().getFullYear(),y=t.getFullYear(),u={day:"numeric",month:"long"};y!==r&&(u.year="numeric");const a=navigator.language||"en-US";return t.toLocaleDateString(a,u)}var O=$e(),Y=g(B(O),4);{var G=e=>{var t=fe(),r=n(t,!0);l(t),H(()=>S(r,A)),i(e,t)},N=e=>{{const t=(u,a=R)=>{var k=me(),b=n(k),v=n(b),f=n(v,!0);l(v);var p=g(v,2),$=n(p,!0);l(p),l(b);var C=g(b,2),o=n(C),x=n(o);l(o);var F=g(o,2),Q=n(F,!0);l(F),l(C),l(k),H((D,m)=>{S(f,D),S($,a().venue),S(x,`${a().songs.length??""} song${a().songs.length>1?"s":""}`),S(Q,m)},[()=>q(a().date),()=>X(a().songs.map(D=>{var m;return((m=d[D])==null?void 0:m.length)||0}).reduce((D,m)=>D+m,0))]),i(u,k)},r=(u,a=R)=>{ie(u,{primaryAction:v=>{{let f=j(()=>`#/set/${a().id}/load`);P(v,{color:"primary",elementType:"a",get href(){return T(f)},variant:"icon",children:(p,$)=>{ue(p,{})},$$slots:{default:!0}})}},secondaryActions:v=>{var f=he(),p=B(f);{let o=j(()=>`#/set/${a().id}/edit`);P(p,{elementType:"a",color:"edit",get href(){return T(o)},variant:"icon",children:(x,F)=>{ce(x,{})},$$slots:{default:!0}})}var $=g(p,2);P($,{color:"delete",onclick:()=>E(a()),variant:"icon",children:(o,x)=>{de(o,{})},$$slots:{default:!0}});var C=g($,2);P(C,{color:"success",onclick:()=>I(a()),variant:"icon",children:(o,x)=>{ge(o,{})},$$slots:{default:!0}}),i(v,f)},$$slots:{primaryAction:!0,secondaryActions:!0}})};let y=j(()=>Object.values(c).toSorted(L));le(e,{get items(){return T(y)},nameDisplay:t,actions:r,$$slots:{nameDisplay:!0,actions:!0}})}};V(Y,e=>{A?e(G):e(N,!1)})}var U=g(Y,2);{var J=e=>{var t=_e(),r=n(t);P(r,{elementType:"a",href:"#/set/add",color:"success",children:(y,u)=>{oe();var a=ee("Add Set");i(y,a)},$$slots:{default:!0}}),l(t),i(e,t)},K=e=>{var t=ye();i(e,t)};V(U,e=>{Object.entries(d).length>0?e(J):e(K,!1)})}i(_,O),re()}export{Fe as component,Ce as universal};
