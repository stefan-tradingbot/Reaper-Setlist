import{g as z,a as W,n as D,B as P,f as X}from"../chunks/PsnSwRbB.js";import{b as Z,a as i,f as h,s as S,t as ee}from"../chunks/Dktx9MQm.js";import{o as te}from"../chunks/cMueOY3v.js";import{p as se,k as ae,s as g,f as B,a as re,c as n,r as l,t as H,y as R,m as T,n as j,q as oe}from"../chunks/Dv93RvCJ.js";import{r as ne,i as V}from"../chunks/5mgx-mTD.js";import{I as le,R as ie,P as ce}from"../chunks/CueYkOdy.js";import{D as de}from"../chunks/BtOcgIR3.js";import{P as ue}from"../chunks/BZbKSdW2.js";const ve=async({fetch:_})=>{try{const a=z(_),[c,d]=await Promise.all([a.sets.list(),a.songs.list()]);return{sets:c,songs:d}}catch(a){return console.error("Error loading sets and songs:",a),{sets:{},songs:{},error:a instanceof Error?a.message:"An unknown error occurred."}}},be=Object.freeze(Object.defineProperty({__proto__:null,load:ve},Symbol.toStringTag,{value:"Module"}));var pe=Z('<svg><path fill="currentColor" d="M19 21H8V7h11m0-2H8a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2m-3-4H4a2 2 0 0 0-2 2v14h2V3h12z"></path></svg>');function ge(_,a){const c=ne(a,["$$slots","$$events","$$legacy"]);var d=pe();W(d,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...c})),i(_,d)}var fe=h('<p style="color: red;"> </p>'),me=h('<div class="set-info svelte-1uha8ag"><div class="set-header svelte-1uha8ag"><span class="date svelte-1uha8ag"> </span> <span class="venue svelte-1uha8ag"> </span></div> <div class="set-details svelte-1uha8ag"><span class="song-count svelte-1uha8ag"> </span> <span class="duration svelte-1uha8ag"> </span></div></div>'),he=h("<!> <!> <!>",1),_e=h('<div class="action-section"><!></div>'),ye=h('<p style="color: var(--text-muted);">No songs available. Please add some songs to get started.</p>'),$e=h("<meta:head><title>Sets - Reaper Setlist</title></meta:head> <h1>Sets</h1> <!> <!>",1);function Fe(_,a){se(a,!0);const c=ae(a.data.sets),d=a.data.songs,A=a.data.error,M=z();te(()=>{A&&D.error(`Failed to load data: ${A}`)});async function E(e){if(confirm("Are you sure you want to delete this set?"))try{await M.sets.delete(e.id),delete c[e.id],D.success("Set deleted successfully")}catch(t){D.error(`Failed to delete set: ${t.message}`)}}async function I(e){const t={...e,id:void 0,venue:`${e.venue} (copy)`};try{const r=await M.sets.add(t);c[r.id]=r,D.success("Set duplicated successfully")}catch(r){D.error(`Failed to duplicate set: ${r.message}`)}}function L(e,t){return e.date!==t.date?new Date(e.date).getTime()-new Date(t.date).getTime():e.venue!==t.venue?e.venue.localeCompare(t.venue):e.id.localeCompare(t.id)}function q(e){const t=new Date(e),r=new Date().getFullYear(),y=t.getFullYear(),u={day:"numeric",month:"long"};y!==r&&(u.year="numeric");const s=navigator.language||"en-US";return t.toLocaleDateString(s,u)}var O=$e(),Y=g(B(O),4);{var G=e=>{var t=fe(),r=n(t,!0);l(t),H(()=>S(r,A)),i(e,t)},N=e=>{{const t=(u,s=R)=>{var k=me(),C=n(k),v=n(C),f=n(v,!0);l(v);var p=g(v,2),$=n(p,!0);l(p),l(C);var b=g(C,2),o=n(b),w=n(o);l(o);var F=g(o,2),Q=n(F,!0);l(F),l(b),l(k),H((x,m)=>{S(f,x),S($,s().venue),S(w,`${s().songs.length??""} song${s().songs.length>1?"s":""}`),S(Q,m)},[()=>q(s().date),()=>X(s().songs.map(x=>{var m;return((m=d[x])==null?void 0:m.length)||0}).reduce((x,m)=>x+m,0))]),i(u,k)},r=(u,s=R)=>{ie(u,{primaryAction:v=>{{let f=j(()=>`#/set/${s().id}/load`);P(v,{color:"primary",elementType:"a",get href(){return T(f)},variant:"icon",children:(p,$)=>{ue(p,{})},$$slots:{default:!0}})}},secondaryActions:v=>{var f=he(),p=B(f);{let o=j(()=>`#/set/${s().id}/edit`);P(p,{elementType:"a",color:"edit",get href(){return T(o)},variant:"icon",children:(w,F)=>{ce(w,{})},$$slots:{default:!0}})}var $=g(p,2);P($,{color:"delete",onclick:()=>E(s()),variant:"icon",children:(o,w)=>{de(o,{})},$$slots:{default:!0}});var b=g($,2);P(b,{color:"success",onclick:()=>I(s()),variant:"icon",children:(o,w)=>{ge(o,{})},$$slots:{default:!0}}),i(v,f)},$$slots:{primaryAction:!0,secondaryActions:!0}})};let y=j(()=>Object.values(c).toSorted(L));le(e,{get items(){return T(y)},nameDisplay:t,actions:r,$$slots:{nameDisplay:!0,actions:!0}})}};V(Y,e=>{A?e(G):e(N,!1)})}var U=g(Y,2);{var J=e=>{var t=_e(),r=n(t);P(r,{elementType:"a",href:"#/set/add",color:"success",children:(y,u)=>{oe();var s=ee("Add Set");i(y,s)},$$slots:{default:!0}}),l(t),i(e,t)},K=e=>{var t=ye();i(e,t)};V(U,e=>{Object.entries(d).length>0?e(J):e(K,!1)})}i(_,O),re()}export{Fe as component,be as universal};
