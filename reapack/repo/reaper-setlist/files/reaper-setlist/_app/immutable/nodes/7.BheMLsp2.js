import{k as O,c as st,e as dt,l as ut,a as Q,g as wt,B as q,m as yt,r as kt,o as $t,n as T}from"../chunks/BL5BhTo2.js";import{f as h,s as M,a as o,t as rt,b as X}from"../chunks/BzJ4SX3Z.js";import{c as p,r as v,s as b,t as j,l as e,p as St,q as E,k as at,v as pt,a as It,o as r,m as Pt,f as G,n as K}from"../chunks/CK57Ve49.js";import{p as ht,i as H,r as Y}from"../chunks/_0x7LJxc.js";import{a as zt}from"../chunks/DgwUmPXI.js";import{F as Rt}from"../chunks/MPz3g0FK.js";import{S as At}from"../chunks/DfYbUBYb.js";const Ct=async({fetch:g})=>{try{return await O.ensureInitialized(g),{folderPath:O.folderPath||"",scriptActionId:O.scriptActionId||""}}catch(s){return{folderPath:"",scriptActionId:"",error:s instanceof Error?s.message:"An unknown error occurred."}}},ne=Object.freeze(Object.defineProperty({__proto__:null,load:Ct},Symbol.toStringTag,{value:"Module"}));var Dt=h('<a class="svelte-kzvegf"> </a>'),Tt=h('<li class="svelte-kzvegf"><!></li>'),Et=h('<ol class="svelte-kzvegf"></ol>'),jt=h('<a class="svelte-kzvegf"> </a>'),Ft=h('<li class="svelte-kzvegf"><!></li>'),Vt=h('<ul class="svelte-kzvegf"></ul>'),Bt=h('<div><h2 class="svelte-kzvegf"> </h2> <!></div>');function ft(g,s){let n=ht(s,"variant",3,"default"),l=ht(s,"listType",3,"unordered");const m={default:"instruction-box--default",success:"instruction-box--success",info:"instruction-box--info",help:"instruction-box--help"};var S=Bt(),F=p(S),x=p(F,!0);v(F);var I=b(F,2);{var U=R=>{var P=Et();dt(P,21,()=>s.steps,k=>k.label,(k,w)=>{var z=Tt(),N=p(z);{var A=d=>{var c=Dt(),C=p(c,!0);v(c),j(()=>{ut(c,"href",`#${e(w).href}`),M(C,e(w).label)}),o(d,c)},V=d=>{var c=rt();j(()=>M(c,e(w).label)),o(d,c)};H(N,d=>{e(w).href?d(A):d(V,!1)})}v(z),o(k,z)}),v(P),o(R,P)},Z=R=>{var P=Vt();dt(P,21,()=>s.steps,k=>k.label,(k,w)=>{var z=Ft(),N=p(z);{var A=d=>{var c=jt(),C=p(c,!0);v(c),j(()=>{ut(c,"href",`#${e(w).href}`),M(C,e(w).label)}),o(d,c)},V=d=>{var c=rt();j(()=>M(c,e(w).label)),o(d,c)};H(N,d=>{e(w).href?d(A):d(V,!1)})}v(z),o(k,z)}),v(P),o(R,P)};H(I,R=>{l()==="ordered"?R(U):R(Z,!1)})}v(S),j(()=>{st(S,1,`instruction-box ${m[n()]??""}`,"svelte-kzvegf"),M(x,s.title)}),o(g,S)}var Lt=X('<svg><path fill="currentColor" d="m23 12l-4-4v3h-9v2h9v3M1 18V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v3h-2V6H3v12h12v-3h2v3a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2"></path></svg>');function Mt(g,s){const n=Y(s,["$$slots","$$events","$$legacy"]);var l=Lt();Q(l,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...n})),o(g,l)}var Ot=X('<svg><path fill="currentColor" d="m14 12l-4-4v3H2v2h8v3m10 2V6a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v3h2V6h12v12H6v-3H4v3a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2"></path></svg>');function Ht(g,s){const n=Y(s,["$$slots","$$events","$$legacy"]);var l=Ot();Q(l,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...n})),o(g,l)}var Ut=X('<svg><path fill="currentColor" d="M17.65 6.35A7.96 7.96 0 0 0 12 4a8 8 0 0 0-8 8a8 8 0 0 0 8 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0 1 12 18a6 6 0 0 1-6-6a6 6 0 0 1 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"></path></svg>');function Nt(g,s){const n=Y(s,["$$slots","$$events","$$legacy"]);var l=Ut();Q(l,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...n})),o(g,l)}var Jt=X('<svg><path fill="currentColor" d="M12.5 5A7.5 7.5 0 0 0 5 12.5a7.5 7.5 0 0 0 7.5 7.5a7.5 7.5 0 0 0 7.5-7.5A7.5 7.5 0 0 0 12.5 5M7 10h2a1 1 0 0 1 1 1v1c0 .5-.38.9-.86.97L10.31 15H9.15L8 13v2H7m5-5h2v1h-2v1h2v1h-2v1h2v1h-2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1m4 0h2v1h-2v3h2v1h-2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1m-8 1v1h1v-1"></path></svg>');function Wt(g,s){const n=Y(s,["$$slots","$$events","$$legacy"]);var l=Jt();Q(l,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...n})),o(g,l)}var qt=h("<!> Refresh Status",1),Gt=h("<div> </div>"),Kt=h('<div class="validation-message validation-message--pending svelte-sz3hb4">Click "Save" to validate this folder path</div>'),Qt=h('<div class="form-group"><label for="backing-tracks-folder">Backing Tracks Root Folder:</label> <input type="text" id="backing-tracks-folder" name="backing-tracks-folder" placeholder="e.g., /path/to/your/backing/tracks"/> <!></div> <div class="submit-section"><!></div>',1),Xt=h("<!> Export Data",1),Yt=h("<!> Import Data",1),Zt=h("<!> Export Recordings",1),te=h('<div class="content svelte-sz3hb4"><h1>Setup</h1> <!> <div class="script-status svelte-sz3hb4"><!> <!></div> <!> <div class="import-export svelte-sz3hb4"><h3>Data Management</h3> <div class="import-export-buttons svelte-sz3hb4"><!> <!></div></div> <div class="import-export svelte-sz3hb4"><h3>Recording Export</h3> <div class="import-export-buttons svelte-sz3hb4"><!></div></div></div>');function ce(g,s){St(s,!0);const n=wt();let l=E(at(s.data.folderPath)),m=E(at(s.data.scriptActionId&&s.data.scriptActionId.trim()!==""?"completed":"pending")),S=E(!1),F=E(!1),x=E("pending"),I=E(""),U=E(at(s.data.folderPath));const Z=[{label:"Add your songs",href:"/song"},{label:"Create setlists",href:"/"}],R=[{label:'Open Reaper and go to "Actions" > "Show Action List".'},{label:"If you installed this via ReaPack, the reaper-setlist.lua script should already be listed here."},{label:'If not, click "New Action" > "Load ReaScript..." and open the reaper-setlist.lua script.'},{label:"Simply run the script to register it."},{label:"Use the refresh button below to check installation status."},{label:"Enter the root folder path where your backing tracks are stored in the form below."},{label:'Click "Save" to store these settings.'}];pt(()=>{!e(F)&&e(m)!=="completed"&&(r(F,!0),k())}),pt(()=>{e(l)!==e(U)&&e(x)!=="pending"&&(r(x,"pending"),r(I,""))});async function P(t){var _;t.preventDefault();let a=(((_=new FormData(t.target).get("backing-tracks-folder"))==null?void 0:_.toString())||"").replaceAll("\\","/");for(;a.includes("//");)a=a.replace("//","/");r(x,"checking"),r(I,"Validating folder..."),r(l,a,!0),r(U,a,!0);try{const f=await n.script.testProjectsFolder(a);if(!f.valid){r(x,"error"),r(I,f.message||"Invalid folder path. Please check the path and try again.",!0);return}await O.updateFolderPath(a),r(x,"success"),r(I,f.message||"Folder path is valid!",!0),T.success("Settings saved successfully!")}catch(f){r(x,"error"),r(I,`Error: ${f.message}`),T.error(`Failed to save settings: ${f.message}`);return}}async function k(){if(!e(S)){r(S,!0),r(m,"running");try{const t=await n.scriptSettings.getScriptActionId();if(t&&t.trim()!==""){O.reset(),await O.initialize(fetch);const y=yt();await n.script.testActionId(y)===`Test action ID received: ${t}`?r(m,"completed"):r(m,"error"),r(m,"completed")}else r(m,"error")}catch(t){console.error("Error checking script installation:",t),r(m,"error")}finally{r(S,!1)}}}async function w(){const t=await n.songs.list(),y=await n.sets.list(),a=JSON.stringify({songs:t,sets:y},null,2),_=new Blob([a],{type:"application/json"}),f=URL.createObjectURL(_),$=document.createElement("a");$.href=f,$.download="reaper-setlist-data.json",document.body.appendChild($),$.click(),document.body.removeChild($),URL.revokeObjectURL(f),T.success("Data exported successfully!")}async function z(){const t=document.createElement("input");t.type="file",t.accept=".json",t.onchange=async y=>{const i=y.target;if(i.files&&i.files.length>0){const a=i.files[0];try{const _=await a.text(),f=JSON.parse(_),$=new Map;for(const B of Object.values(f.songs)){const{id:L,...J}=B,u=await n.songs.add(J);$.set(L,u.id)}for(const B of Object.values(f.sets)){const{...L}=B,J={...L,songs:B.songs.map(u=>$.get(u)||u)};await n.sets.add(J)}T.success("Data imported successfully!")}catch(_){T.error(`Failed to import data: ${_.message}`)}}},t.click()}async function N(){try{await n.script.exportRecordings(),T.success("Recording export started! Check Reaper for progress.")}catch(t){T.error(`Failed to start export: ${t.message}`)}}var A=te(),V=b(p(A),2);{var d=t=>{ft(t,{title:"Script Installation",get steps(){return R},variant:"help",listType:"ordered"})},c=t=>{ft(t,{title:"Next steps:",get steps(){return Z},variant:"success",listType:"unordered"})};H(V,t=>{e(m)==="error"?t(d):t(c,!1)})}var C=b(V,2),ot=p(C);const gt=Pt(()=>e(m)==="completed"?"Script is installed and ready to use":e(m)==="running"?"Checking installation status...":"Script not detected. Please install the script in Reaper and refresh.");At(ot,{title:"Script Installation Status",get description(){return e(gt)},get status(){return e(m)}});var mt=b(ot,2);q(mt,{elementType:"button",onclick:k,get disabled(){return e(S)},variant:"text",children:(t,y)=>{var i=qt(),a=G(i);Nt(a,{}),K(),o(t,i)},$$slots:{default:!0}}),v(C);var lt=b(C,2);Rt(lt,{onsubmit:P,children:(t,y)=>{var i=Qt(),a=G(i),_=b(p(a),2);kt(_);var f=b(_,2);{var $=u=>{var D=Gt(),W=p(D,!0);v(D),j(()=>{st(D,1,`validation-message validation-message--${e(x)??""}`,"svelte-sz3hb4"),M(W,e(I))}),o(u,D)},B=(u,D)=>{{var W=et=>{var xt=Kt();o(et,xt)};H(u,et=>{e(l)&&e(l).trim()!==""&&e(l)!==e(U)&&et(W)},D)}};H(f,u=>{e(I)?u($):u(B,!1)})}v(a);var L=b(a,2),J=p(L);q(J,{elementType:"submit",color:"success",children:(u,D)=>{K();var W=rt("Save");o(u,W)},$$slots:{default:!0}}),v(L),j(()=>st(_,1,$t(e(x)==="success"?"success":e(x)==="warning"?"warning":e(x)==="error"?"error":""))),zt(_,()=>e(l),u=>r(l,u)),o(t,i)},$$slots:{default:!0}});var tt=b(lt,2),it=b(p(tt),2),nt=p(it);q(nt,{elementType:"button",onclick:w,variant:"text",children:(t,y)=>{var i=Xt(),a=G(i);Mt(a,{}),K(),o(t,i)},$$slots:{default:!0}});var _t=b(nt,2);q(_t,{elementType:"button",onclick:z,variant:"text",children:(t,y)=>{var i=Yt(),a=G(i);Ht(a,{}),K(),o(t,i)},$$slots:{default:!0}}),v(it),v(tt);var ct=b(tt,2),vt=b(p(ct),2),bt=p(vt);q(bt,{elementType:"button",onclick:N,variant:"text",children:(t,y)=>{var i=Zt(),a=G(i);Wt(a,{}),K(),o(t,i)},$$slots:{default:!0}}),v(vt),v(ct),v(A),o(g,A),It()}export{ce as component,ne as universal};
