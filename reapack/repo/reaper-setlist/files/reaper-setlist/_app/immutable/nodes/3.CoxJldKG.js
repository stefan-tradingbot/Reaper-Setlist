import{b as L,a as h,d as _e,f as I,c as zt,s as m,t as be}from"../chunks/Dktx9MQm.js";import{o as $e,a as we}from"../chunks/cMueOY3v.js";import{p as xe,o as F,k as Rt,s as o,f as V,a as ke,c as r,v as _,m as t,n as g,r as s,t as rt,q as Te,ab as Vt}from"../chunks/Dv93RvCJ.js";import{a as B,g as Se,n as C,B as A,e as Pe,j as Y,f as Me}from"../chunks/PsnSwRbB.js";import{r as D,i as H}from"../chunks/5mgx-mTD.js";import{P as Fe}from"../chunks/BZbKSdW2.js";const st=0,at=1,Yt=2,Ce=5;var Ae=L('<svg><path fill="currentColor" d="M14 19h4V5h-4M6 19h4V5H6z"></path></svg>');function Ie(f,u){const l=D(u,["$$slots","$$events","$$legacy"]);var a=Ae();B(a,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...l})),h(f,a)}var Le=L('<svg><path fill="currentColor" d="M19 12c0 3.86-3.14 7-7 7s-7-3.14-7-7s3.14-7 7-7s7 3.14 7 7"></path></svg>');function Be(f,u){const l=D(u,["$$slots","$$events","$$legacy"]);var a=Le();B(a,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...l})),h(f,a)}var De=L('<svg><path fill="currentColor" d="M16 18h2V6h-2M6 18l8.5-6L6 6z"></path></svg>');function Ee(f,u){const l=D(u,["$$slots","$$events","$$legacy"]);var a=De();B(a,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...l})),h(f,a)}var je=L('<svg><path fill="currentColor" d="M6 18V6h2v12zm3.5-6L18 6v12z"></path></svg>');function ze(f,u){const l=D(u,["$$slots","$$events","$$legacy"]);var a=je();B(a,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...l})),h(f,a)}var Re=L('<svg><path fill="currentColor" d="M18 18H6V6h12z"></path></svg>');function Ve(f,u){const l=D(u,["$$slots","$$events","$$legacy"]);var a=Re();B(a,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...l})),h(f,a)}var Ye=I('<div class="next-song svelte-hy9bcf"><div class="next-song-name svelte-hy9bcf"> </div> <div class="next-song-duration svelte-hy9bcf"> </div></div>'),He=I('<div class="set-complete svelte-hy9bcf">Set Complete!</div>'),Ne=I('<button class="marker-button svelte-hy9bcf"><div class="marker-name svelte-hy9bcf"> </div> <div class="marker-time svelte-hy9bcf"> </div></button>'),Ue=I('<div class="current-song-section svelte-hy9bcf"><div class="song-info svelte-hy9bcf"><div class="song-meta svelte-hy9bcf"><span class="song-number"> </span></div> <h2 class="song-title svelte-hy9bcf"> </h2></div> <div class="track-navigation svelte-hy9bcf"><!> <!></div> <div class="next-up-info svelte-hy9bcf"><div class="next-up-header svelte-hy9bcf"><h4 class="svelte-hy9bcf">Next Up</h4> <!></div></div></div> <div class="transport-section svelte-hy9bcf"><div class="transport-controls svelte-hy9bcf"><div class="main-controls svelte-hy9bcf"><!> <!> <!></div></div> <div class="song-progress"><div class="progress-group svelte-hy9bcf"><div class="progress-label svelte-hy9bcf"><span>Song Progress</span> <span class="time-display svelte-hy9bcf"> </span></div> <div class="progress-bar-container svelte-hy9bcf"><div class="progress-bar svelte-hy9bcf"><div class="progress-fill svelte-hy9bcf"></div> <div class="progress-handle svelte-hy9bcf"></div></div></div> <div class="remaining-time svelte-hy9bcf"> </div></div></div></div> <div class="set-section svelte-hy9bcf"><div class="set-progress"><div class="progress-group svelte-hy9bcf"><div class="progress-label svelte-hy9bcf"><span>Set Progress</span> <span class="time-display svelte-hy9bcf"> </span></div> <div class="progress-bar-container svelte-hy9bcf"><div class="progress-bar set-progress-bar svelte-hy9bcf"><div class="progress-fill svelte-hy9bcf"></div> <div class="progress-handle svelte-hy9bcf"></div></div></div> <div class="remaining-time svelte-hy9bcf"> </div></div></div></div> <div class="markers-section svelte-hy9bcf"><h3 class="svelte-hy9bcf">Song Markers</h3> <div class="markers-grid svelte-hy9bcf"><button class="marker-button svelte-hy9bcf"><div class="marker-name svelte-hy9bcf">Start</div> <div class="marker-time svelte-hy9bcf"> </div></button> <!></div></div>',1),Oe=I('<div class="no-setlist svelte-hy9bcf"><h2 class="svelte-hy9bcf">No Setlist Loaded</h2> <p class="svelte-hy9bcf">Please load a setlist to begin playing.</p> <!></div>'),Ge=I('<meta:head><title>Player - Reaper Setlist</title></meta:head> <div class="player-container svelte-hy9bcf"><h1>Live Player</h1> <!></div>',1);function Ze(f,u){xe(u,!0);const l=Se();let a=F(null),v=F(0),b=F(Rt(st)),S=F(0),ot=g(()=>t(a)?t(a).slice(0,t(v)).reduce((e,i)=>e+(i.length||0),0)+t(S):0),N=F(null),U=F(null);const O=g(()=>!t(a)||t(v)<0||t(v)>=t(a).length?null:t(a)[t(v)]||null);let it=F(Rt([]));const E=g(()=>{var e;return((e=t(O))==null?void 0:e.length)||0}),Ht=g(()=>Math.max(0,t(E)-t(S))),G=g(()=>t(a)?t(a).reduce((e,i)=>e+(i.length||0),0):0),Nt=g(()=>t(a)?(()=>{let e=0;for(let i=t(v);i<t(a).length;i++){const T=t(a)[i].length||0;i===t(v)?e+=Math.max(0,T-t(S)):e+=T}return e})():0),nt=g(()=>t(E)===0?0:Math.min(100,t(S)/t(E)*100)),lt=g(()=>t(G)===0?0:Math.min(100,t(ot)/t(G)*100));function x(e){const i=Math.floor(e/60),k=Math.floor(e%60);return`${i}:${k.toString().padStart(2,"0")}`}function vt(e){return e.replace(/\.[^/.]+$/,"")}async function Ut(){try{if(t(b)===at){const e=await l.reaper.pause();$(e)}else if(t(b)===Yt||t(b)===st){const e=await l.reaper.play();$(e)}}catch(e){C.error(`Failed to toggle playback: ${e.message}`)}}async function Ot(){try{const e=await l.reaper.stop();$(e)}catch(e){C.error(`Failed to stop playback: ${e.message}`)}}async function Gt(){if(t(v)>0){Vt(v,-1);const e=await l.reaper.previousTab();q(e.markers),$(e.transport)}}async function qt(){if(t(a)&&t(v)<t(a).length-1){Vt(v);const e=await l.reaper.nextTab();q(e.markers),$(e.transport)}}async function Jt(e){try{const i=await l.reaper.goToMarker(e.id);$(i)}catch(i){C.error(`Failed to jump to marker: ${i.message}`),console.error("Failed to jump to marker:",i)}}async function Kt(){try{const e=await l.reaper.goToStart();$(e)}catch(e){C.error(`Failed to jump to song start: ${e.message}`),console.error("Failed to jump to song start:",e)}}async function Qt(){try{const e=await l.reaper.record();$(e)}catch(e){C.error(`Failed to toggle recording: ${e.message}`),console.error("Failed to toggle recording:",e)}}function $(e){e?(_(b,e.playState,!0),_(S,e.positionSeconds,!0)):(_(b,st,!0),_(S,0))}function q(e){_(it,e,!0)}async function ct(){try{const e=await l.reaper.getTransport();$(e)}catch(e){console.error("Failed to update transport:",e)}}async function dt(){try{const e=await l.reaper.getMarkers();q(e)}catch(e){console.error("Failed to load markers:",e)}}async function pt(){try{const e=await l.script.getOpenTabs();(t(a)!==e.tabs||t(v)!==e.activeIndex)&&(_(a,e.tabs,!0),_(v,e.activeIndex,!0),await dt()),(t(v)<0||t(v)>=t(a).length)&&_(v,0)}catch(e){console.error(`Failed to refresh tabs: ${e.message}`)}}$e(async()=>{try{_(U,window.setInterval(pt,5e3),!0),_(N,window.setInterval(ct,1e3),!0),await pt(),await dt(),await ct()}catch(e){C.error(`Failed to load initial data: ${e.message}`),console.error(`Failed to load data: ${e.message}`)}}),we(()=>{t(N)&&window.clearInterval(t(N)),t(U)&&window.clearInterval(t(U))});var ht=Ge(),gt=o(V(ht),2),Wt=o(r(gt),2);{var Xt=e=>{var i=Ue(),k=V(i),T=r(k),j=r(T),z=r(j),te=r(z);s(z),s(j);var ft=o(j,2),ee=r(ft,!0);s(ft),s(T);var J=o(T,2),ut=r(J);{let n=g(()=>t(v)===0);A(ut,{variant:"icon",onclick:Gt,get disabled(){return t(n)},children:(c,d)=>{ze(c,{})},$$slots:{default:!0}})}var re=o(ut,2);{let n=g(()=>!t(a)||t(v)>=t(a).length-1);A(re,{variant:"icon",onclick:qt,get disabled(){return t(n)},children:(c,d)=>{Ee(c,{})},$$slots:{default:!0}})}s(J);var mt=o(J,2),yt=r(mt),se=o(r(yt),2);{var ae=n=>{const c=g(()=>t(a)[t(v)+1]);var d=zt(),w=V(d);{var P=y=>{var p=Ye(),M=r(p),fe=r(M,!0);s(M);var jt=o(M,2),ue=r(jt,!0);s(jt),s(p),rt((me,ye)=>{m(fe,me),m(ue,ye)},[()=>vt(t(c).name),()=>Me(t(c).length)]),h(y,p)};H(w,y=>{t(c)&&y(P)})}h(n,d)},oe=n=>{var c=He();h(n,c)};H(se,n=>{t(v)<t(a).length-1?n(ae):n(oe,!1)})}s(yt),s(mt),s(k);var K=o(k,2),Q=r(K),_t=r(Q),bt=r(_t);{let n=g(()=>t(b)===at||t(b)===Yt?"delete":"primary");A(bt,{variant:"icon",onclick:Ot,get color(){return t(n)},children:(c,d)=>{Ve(c,{})},$$slots:{default:!0}})}var $t=o(bt,2);A($t,{variant:"icon",onclick:Ut,color:"success",children:(n,c)=>{var d=zt(),w=V(d);{var P=p=>{Ie(p,{})},y=p=>{Fe(p,{})};H(w,p=>{t(b)===at?p(P):p(y,!1)})}h(n,d)},$$slots:{default:!0}});var ie=o($t,2);{let n=g(()=>t(b)===Ce?"delete":"primary");A(ie,{variant:"icon",onclick:Qt,get color(){return t(n)},children:(c,d)=>{Be(c,{})},$$slots:{default:!0}})}s(_t),s(Q);var wt=o(Q,2),xt=r(wt),W=r(xt),kt=o(r(W),2),ne=r(kt);s(kt),s(W);var X=o(W,2),Tt=r(X),St=r(Tt),le=o(St,2);s(Tt),s(X);var Pt=o(X,2),ve=r(Pt);s(Pt),s(xt),s(wt),s(K);var Z=o(K,2),Mt=r(Z),Ft=r(Mt),tt=r(Ft),Ct=o(r(tt),2),ce=r(Ct);s(Ct),s(tt);var et=o(tt,2),At=r(et),It=r(At),de=o(It,2);s(At),s(et);var Lt=o(et,2),pe=r(Lt);s(Lt),s(Ft),s(Mt),s(Z);var Bt=o(Z,2),Dt=o(r(Bt),2),R=r(Dt);R.__click=()=>Kt();var Et=o(r(R),2),he=r(Et,!0);s(Et),s(R);var ge=o(R,2);Pe(ge,17,()=>t(it),n=>n.id,(n,c)=>{var d=Ne();d.__click=()=>Jt(t(c));var w=r(d),P=r(w,!0);s(w);var y=o(w,2),p=r(y,!0);s(y),s(d),rt(M=>{m(P,t(c).name),m(p,M)},[()=>x(t(c).position)]),h(n,d)}),s(Dt),s(Bt),rt((n,c,d,w,P,y,p,M)=>{m(te,`Track ${t(v)+1} of ${t(a).length??""}`),m(ee,n),m(ne,`${c??""} / ${d??""}`),Y(St,`width: ${t(nt)??""}%`),Y(le,`left: ${t(nt)??""}%`),m(ve,`-${w??""}`),m(ce,`${P??""} / ${y??""}`),Y(It,`width: ${t(lt)??""}%`),Y(de,`left: ${t(lt)??""}%`),m(pe,`-${p??""}`),m(he,M)},[()=>vt(t(O).name),()=>x(t(S)),()=>x(t(E)),()=>x(t(Ht)),()=>x(t(ot)),()=>x(t(G)),()=>x(t(Nt)),()=>x(0)]),h(e,i)},Zt=e=>{var i=Oe(),k=o(r(i),4);A(k,{elementType:"a",href:"#/",color:"primary",children:(T,j)=>{Te();var z=be("Browse Setlists");h(T,z)},$$slots:{default:!0}}),s(i),h(e,i)};H(Wt,e=>{t(a)&&t(O)?e(Xt):e(Zt,!1)})}s(gt),h(f,ht),ke()}_e(["click"]);export{Ze as component};
