import{b as B,a as h,d as _t,f as L,c as ze,s as m,t as bt}from"../chunks/B_oGNvez.js";import{o as $t,a as kt}from"../chunks/D9zGA_ww.js";import{p as xt,o as F,k as Re,s as o,f as V,a as wt,c as r,v as _,m as e,n as f,r as a,t as re,q as Tt,ab as Ve}from"../chunks/BWSO7Bi6.js";import{r as D,i as Y}from"../chunks/DnK7exoB.js";import{a as C,g as St,n as A,B as I,e as Pt,j as H,f as Mt}from"../chunks/DEfdFb_i.js";import{P as Ft}from"../chunks/BKTy_5NM.js";const ae=0,se=1,Ye=2,At=5;var It=B('<svg><path fill="currentColor" d="M14 19h4V5h-4M6 19h4V5H6z"></path></svg>');function Lt(g,u){const l=D(u,["$$slots","$$events","$$legacy"]);var s=It();C(s,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...l})),h(g,s)}var Bt=B('<svg><path fill="currentColor" d="M19 12c0 3.86-3.14 7-7 7s-7-3.14-7-7s3.14-7 7-7s7 3.14 7 7"></path></svg>');function Dt(g,u){const l=D(u,["$$slots","$$events","$$legacy"]);var s=Bt();C(s,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...l})),h(g,s)}var Ct=B('<svg><path fill="currentColor" d="M16 18h2V6h-2M6 18l8.5-6L6 6z"></path></svg>');function Et(g,u){const l=D(u,["$$slots","$$events","$$legacy"]);var s=Ct();C(s,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...l})),h(g,s)}var jt=B('<svg><path fill="currentColor" d="M6 18V6h2v12zm3.5-6L18 6v12z"></path></svg>');function zt(g,u){const l=D(u,["$$slots","$$events","$$legacy"]);var s=jt();C(s,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...l})),h(g,s)}var Rt=B('<svg><path fill="currentColor" d="M18 18H6V6h12z"></path></svg>');function Vt(g,u){const l=D(u,["$$slots","$$events","$$legacy"]);var s=Rt();C(s,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...l})),h(g,s)}var Yt=L('<div class="next-song svelte-hy9bcf"><div class="next-song-name svelte-hy9bcf"> </div> <div class="next-song-duration svelte-hy9bcf"> </div></div>'),Ht=L('<div class="set-complete svelte-hy9bcf">Set Complete!</div>'),Nt=L('<button class="marker-button svelte-hy9bcf"><div class="marker-name svelte-hy9bcf"> </div> <div class="marker-time svelte-hy9bcf"> </div></button>'),Ut=L('<div class="current-song-section svelte-hy9bcf"><div class="song-info svelte-hy9bcf"><div class="song-meta svelte-hy9bcf"><span class="song-number"> </span></div> <h2 class="song-title svelte-hy9bcf"> </h2></div> <div class="track-navigation svelte-hy9bcf"><!> <!></div> <div class="next-up-info svelte-hy9bcf"><div class="next-up-header svelte-hy9bcf"><h4 class="svelte-hy9bcf">Next Up</h4> <!></div></div></div> <div class="transport-section svelte-hy9bcf"><div class="transport-controls svelte-hy9bcf"><div class="main-controls svelte-hy9bcf"><!> <!> <!></div></div> <div class="song-progress"><div class="progress-group svelte-hy9bcf"><div class="progress-label svelte-hy9bcf"><span>Song Progress</span> <span class="time-display svelte-hy9bcf"> </span></div> <div class="progress-bar-container svelte-hy9bcf"><div class="progress-bar svelte-hy9bcf"><div class="progress-fill svelte-hy9bcf"></div> <div class="progress-handle svelte-hy9bcf"></div></div></div> <div class="remaining-time svelte-hy9bcf"> </div></div></div></div> <div class="set-section svelte-hy9bcf"><div class="set-progress"><div class="progress-group svelte-hy9bcf"><div class="progress-label svelte-hy9bcf"><span>Set Progress</span> <span class="time-display svelte-hy9bcf"> </span></div> <div class="progress-bar-container svelte-hy9bcf"><div class="progress-bar set-progress-bar svelte-hy9bcf"><div class="progress-fill svelte-hy9bcf"></div> <div class="progress-handle svelte-hy9bcf"></div></div></div> <div class="remaining-time svelte-hy9bcf"> </div></div></div></div> <div class="markers-section svelte-hy9bcf"><h3 class="svelte-hy9bcf">Song Markers</h3> <div class="markers-grid svelte-hy9bcf"><button class="marker-button svelte-hy9bcf"><div class="marker-name svelte-hy9bcf">Start</div> <div class="marker-time svelte-hy9bcf"> </div></button> <!></div></div>',1),Ot=L('<div class="no-setlist svelte-hy9bcf"><h2 class="svelte-hy9bcf">No Setlist Loaded</h2> <p class="svelte-hy9bcf">Please load a setlist to begin playing.</p> <!></div>'),Gt=L('<meta:head><title>Player - Reaper Setlist</title></meta:head> <div class="player-container svelte-hy9bcf"><h1>Live Player</h1> <!></div>',1);function Zt(g,u){xt(u,!0);const l=St();let s=F(null),v=F(0),b=F(Re(ae)),S=F(0),oe=f(()=>e(s)?e(s).slice(0,e(v)).reduce((t,i)=>t+(i.length||0),0)+e(S):0),N=F(null),U=F(null);const O=f(()=>!e(s)||e(v)<0||e(v)>=e(s).length?null:e(s)[e(v)]||null);let ie=F(Re([]));const E=f(()=>{var t;return((t=e(O))==null?void 0:t.length)||0}),He=f(()=>Math.max(0,e(E)-e(S))),G=f(()=>e(s)?e(s).reduce((t,i)=>t+(i.length||0),0):0),Ne=f(()=>e(s)?(()=>{let t=0;for(let i=e(v);i<e(s).length;i++){const T=e(s)[i].length||0;i===e(v)?t+=Math.max(0,T-e(S)):t+=T}return t})():0),ne=f(()=>e(E)===0?0:Math.min(100,e(S)/e(E)*100)),le=f(()=>e(G)===0?0:Math.min(100,e(oe)/e(G)*100));function x(t){const i=Math.floor(t/60),w=Math.floor(t%60);return`${i}:${w.toString().padStart(2,"0")}`}function ve(t){return t.replace(/\.[^/.]+$/,"")}async function Ue(){try{if(e(b)===se){const t=await l.reaper.pause();$(t)}else if(e(b)===Ye||e(b)===ae){const t=await l.reaper.play();$(t)}}catch(t){A.error(`Failed to toggle playback: ${t.message}`)}}async function Oe(){try{const t=await l.reaper.stop();$(t)}catch(t){A.error(`Failed to stop playback: ${t.message}`)}}async function Ge(){if(e(v)>0){Ve(v,-1);const t=await l.reaper.previousTab();q(t.markers),$(t.transport)}}async function qe(){if(e(s)&&e(v)<e(s).length-1){Ve(v);const t=await l.reaper.nextTab();q(t.markers),$(t.transport)}}async function Je(t){try{const i=await l.reaper.goToMarker(t.id);$(i)}catch(i){A.error(`Failed to jump to marker: ${i.message}`),console.error("Failed to jump to marker:",i)}}async function Ke(){try{const t=await l.reaper.goToStart();$(t)}catch(t){A.error(`Failed to jump to song start: ${t.message}`),console.error("Failed to jump to song start:",t)}}async function Qe(){try{const t=await l.reaper.record();$(t)}catch(t){A.error(`Failed to toggle recording: ${t.message}`),console.error("Failed to toggle recording:",t)}}function $(t){t?(_(b,t.playState,!0),_(S,t.positionSeconds,!0)):(_(b,ae,!0),_(S,0))}function q(t){_(ie,t,!0)}async function ce(){try{const t=await l.reaper.getTransport();$(t)}catch(t){console.error("Failed to update transport:",t)}}async function de(){try{const t=await l.reaper.getMarkers();q(t)}catch(t){console.error("Failed to load markers:",t)}}async function pe(){try{const t=await l.script.getOpenTabs();(e(s)!==t.tabs||e(v)!==t.activeIndex)&&(_(s,t.tabs,!0),_(v,t.activeIndex,!0),await de()),(e(v)<0||e(v)>=e(s).length)&&_(v,0)}catch(t){console.error(`Failed to refresh tabs: ${t.message}`)}}$t(async()=>{try{_(U,window.setInterval(pe,5e3),!0),_(N,window.setInterval(ce,1e3),!0),await pe(),await de(),await ce()}catch(t){A.error(`Failed to load initial data: ${t.message}`),console.error(`Failed to load data: ${t.message}`)}}),kt(()=>{e(N)&&window.clearInterval(e(N)),e(U)&&window.clearInterval(e(U))});var he=Gt(),fe=o(V(he),2),We=o(r(fe),2);{var Xe=t=>{var i=Ut(),w=V(i),T=r(w),j=r(T),z=r(j),et=r(z);a(z),a(j);var ge=o(j,2),tt=r(ge,!0);a(ge),a(T);var J=o(T,2),ue=r(J);{let n=f(()=>e(v)===0);I(ue,{variant:"icon",onclick:Ge,get disabled(){return e(n)},children:(c,d)=>{zt(c,{})},$$slots:{default:!0}})}var rt=o(ue,2);{let n=f(()=>!e(s)||e(v)>=e(s).length-1);I(rt,{variant:"icon",onclick:qe,get disabled(){return e(n)},children:(c,d)=>{Et(c,{})},$$slots:{default:!0}})}a(J);var me=o(J,2),ye=r(me),at=o(r(ye),2);{var st=n=>{const c=f(()=>e(s)[e(v)+1]);var d=ze(),k=V(d);{var P=y=>{var p=Yt(),M=r(p),gt=r(M,!0);a(M);var je=o(M,2),ut=r(je,!0);a(je),a(p),re((mt,yt)=>{m(gt,mt),m(ut,yt)},[()=>ve(e(c).name),()=>Mt(e(c).length)]),h(y,p)};Y(k,y=>{e(c)&&y(P)})}h(n,d)},ot=n=>{var c=Ht();h(n,c)};Y(at,n=>{e(v)<e(s).length-1?n(st):n(ot,!1)})}a(ye),a(me),a(w);var K=o(w,2),Q=r(K),_e=r(Q),be=r(_e);{let n=f(()=>e(b)===se||e(b)===Ye?"delete":"primary");I(be,{variant:"icon",onclick:Oe,get color(){return e(n)},children:(c,d)=>{Vt(c,{})},$$slots:{default:!0}})}var $e=o(be,2);I($e,{variant:"icon",onclick:Ue,color:"success",children:(n,c)=>{var d=ze(),k=V(d);{var P=p=>{Lt(p,{})},y=p=>{Ft(p,{})};Y(k,p=>{e(b)===se?p(P):p(y,!1)})}h(n,d)},$$slots:{default:!0}});var it=o($e,2);{let n=f(()=>e(b)===At?"delete":"primary");I(it,{variant:"icon",onclick:Qe,get color(){return e(n)},children:(c,d)=>{Dt(c,{})},$$slots:{default:!0}})}a(_e),a(Q);var ke=o(Q,2),xe=r(ke),W=r(xe),we=o(r(W),2),nt=r(we);a(we),a(W);var X=o(W,2),Te=r(X),Se=r(Te),lt=o(Se,2);a(Te),a(X);var Pe=o(X,2),vt=r(Pe);a(Pe),a(xe),a(ke),a(K);var Z=o(K,2),Me=r(Z),Fe=r(Me),ee=r(Fe),Ae=o(r(ee),2),ct=r(Ae);a(Ae),a(ee);var te=o(ee,2),Ie=r(te),Le=r(Ie),dt=o(Le,2);a(Ie),a(te);var Be=o(te,2),pt=r(Be);a(Be),a(Fe),a(Me),a(Z);var De=o(Z,2),Ce=o(r(De),2),R=r(Ce);R.__click=()=>Ke();var Ee=o(r(R),2),ht=r(Ee,!0);a(Ee),a(R);var ft=o(R,2);Pt(ft,17,()=>e(ie),n=>n.id,(n,c)=>{var d=Nt();d.__click=()=>Je(e(c));var k=r(d),P=r(k,!0);a(k);var y=o(k,2),p=r(y,!0);a(y),a(d),re(M=>{m(P,e(c).name),m(p,M)},[()=>x(e(c).position)]),h(n,d)}),a(Ce),a(De),re((n,c,d,k,P,y,p,M)=>{m(et,`Track ${e(v)+1} of ${e(s).length??""}`),m(tt,n),m(nt,`${c??""} / ${d??""}`),H(Se,`width: ${e(ne)??""}%`),H(lt,`left: ${e(ne)??""}%`),m(vt,`-${k??""}`),m(ct,`${P??""} / ${y??""}`),H(Le,`width: ${e(le)??""}%`),H(dt,`left: ${e(le)??""}%`),m(pt,`-${p??""}`),m(ht,M)},[()=>ve(e(O).name),()=>x(e(S)),()=>x(e(E)),()=>x(e(He)),()=>x(e(oe)),()=>x(e(G)),()=>x(e(Ne)),()=>x(0)]),h(t,i)},Ze=t=>{var i=Ot(),w=o(r(i),4);I(w,{elementType:"a",href:"#/",color:"primary",children:(T,j)=>{Tt();var z=bt("Browse Setlists");h(T,z)},$$slots:{default:!0}}),a(i),h(t,i)};Y(We,t=>{e(s)&&e(O)?t(Xe):t(Ze,!1)})}a(fe),h(g,he),wt()}_t(["click"]);export{Zt as component};
