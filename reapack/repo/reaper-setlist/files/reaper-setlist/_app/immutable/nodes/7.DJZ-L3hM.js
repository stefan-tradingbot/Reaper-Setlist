import{k as U,c as rt,e as dt,l as ut,a as Q,g as yt,m as $t,B as G,r as kt,o as wt,n as E}from"../chunks/DEfdFb_i.js";import{f as h,s as H,a as r,t as st,b as X,c as St}from"../chunks/B_oGNvez.js";import{c as p,r as v,s as b,t as F,m as e,p as It,o as j,k as at,w as pt,v as o,a as Pt,n as Rt,f as O,q as K}from"../chunks/BWSO7Bi6.js";import{p as ht,i as N,r as Y}from"../chunks/DnK7exoB.js";import{a as At}from"../chunks/pJQC24l2.js";import{F as Dt}from"../chunks/BMeno8qO.js";import{S as Tt}from"../chunks/hlp0wd2_.js";const Ct=async({fetch:g})=>{try{return await U.ensureInitialized(g),{folderPath:U.folderPath||"",scriptActionId:U.scriptActionId||""}}catch(s){return{folderPath:"",scriptActionId:"",error:s instanceof Error?s.message:"An unknown error occurred."}}},ce=Object.freeze(Object.defineProperty({__proto__:null,load:Ct},Symbol.toStringTag,{value:"Module"}));var Et=h('<a class="svelte-1h10f03"> </a>'),jt=h('<li class="svelte-1h10f03"><!></li>'),Ft=h('<ol class="svelte-1h10f03"></ol>'),Vt=h('<a class="svelte-1h10f03"> </a>'),Bt=h('<li class="svelte-1h10f03"><!></li>'),Lt=h('<ul class="svelte-1h10f03"></ul>'),Mt=h('<div><h2 class="svelte-1h10f03"> </h2> <!></div>');function ft(g,s){let n=ht(s,"variant",3,"default"),i=ht(s,"listType",3,"unordered");const m={default:"instruction-box--default",success:"instruction-box--success",info:"instruction-box--info",help:"instruction-box--help"};var S=Mt(),V=p(S),x=p(V,!0);v(V);var I=b(V,2);{var z=A=>{var P=Ft();dt(P,21,()=>s.steps,k=>k.label,(k,y)=>{var R=jt(),J=p(R);{var T=d=>{var c=Et(),C=p(c,!0);v(c),F(()=>{ut(c,"href",`#${e(y).href}`),H(C,e(y).label)}),r(d,c)},B=d=>{var c=st();F(()=>H(c,e(y).label)),r(d,c)};N(J,d=>{e(y).href?d(T):d(B,!1)})}v(R),r(k,R)}),v(P),r(A,P)},Z=A=>{var P=Lt();dt(P,21,()=>s.steps,k=>k.label,(k,y)=>{var R=Bt(),J=p(R);{var T=d=>{var c=Vt(),C=p(c,!0);v(c),F(()=>{ut(c,"href",`#${e(y).href}`),H(C,e(y).label)}),r(d,c)},B=d=>{var c=st();F(()=>H(c,e(y).label)),r(d,c)};N(J,d=>{e(y).href?d(T):d(B,!1)})}v(R),r(k,R)}),v(P),r(A,P)};N(I,A=>{i()==="ordered"?A(z):A(Z,!1)})}v(S),F(()=>{rt(S,1,`instruction-box ${m[n()]??""}`,"svelte-1h10f03"),H(x,s.title)}),r(g,S)}var Ot=X('<svg><path fill="currentColor" d="m23 12l-4-4v3h-9v2h9v3M1 18V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v3h-2V6H3v12h12v-3h2v3a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2"></path></svg>');function Ht(g,s){const n=Y(s,["$$slots","$$events","$$legacy"]);var i=Ot();Q(i,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n})),r(g,i)}var Ut=X('<svg><path fill="currentColor" d="m14 12l-4-4v3H2v2h8v3m10 2V6a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v3h2V6h12v12H6v-3H4v3a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2"></path></svg>');function Nt(g,s){const n=Y(s,["$$slots","$$events","$$legacy"]);var i=Ut();Q(i,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n})),r(g,i)}var zt=X('<svg><path fill="currentColor" d="M17.65 6.35A7.96 7.96 0 0 0 12 4a8 8 0 0 0-8 8a8 8 0 0 0 8 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0 1 12 18a6 6 0 0 1-6-6a6 6 0 0 1 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"></path></svg>');function Jt(g,s){const n=Y(s,["$$slots","$$events","$$legacy"]);var i=zt();Q(i,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n})),r(g,i)}var Wt=X('<svg><path fill="currentColor" d="M12.5 5A7.5 7.5 0 0 0 5 12.5a7.5 7.5 0 0 0 7.5 7.5a7.5 7.5 0 0 0 7.5-7.5A7.5 7.5 0 0 0 12.5 5M7 10h2a1 1 0 0 1 1 1v1c0 .5-.38.9-.86.97L10.31 15H9.15L8 13v2H7m5-5h2v1h-2v1h2v1h-2v1h2v1h-2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1m4 0h2v1h-2v3h2v1h-2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1m-8 1v1h1v-1"></path></svg>');function qt(g,s){const n=Y(s,["$$slots","$$events","$$legacy"]);var i=Wt();Q(i,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n})),r(g,i)}var Gt=h("<!> Refresh Status",1),Kt=h("<div> </div>"),Qt=h('<div class="validation-message validation-message--pending svelte-g40i6i">Click "Save" to validate this folder path</div>'),Xt=h('<div class="form-group"><label for="backing-tracks-folder">Backing Tracks Root Folder:</label> <input type="text" id="backing-tracks-folder" name="backing-tracks-folder" placeholder="e.g., /path/to/your/backing/tracks"/> <!></div> <div class="submit-section"><!></div>',1),Yt=h("<!> Export Data",1),Zt=h("<!> Import Data",1),te=h("<!> Export Recordings",1),ee=h('<div class="content svelte-g40i6i"><h1>Setup</h1> <!> <div class="script-status svelte-g40i6i"><!> <!></div> <!> <div class="import-export svelte-g40i6i"><h3>Data Management</h3> <div class="import-export-buttons svelte-g40i6i"><!> <!></div></div> <div class="import-export svelte-g40i6i"><h3>Recording Export</h3> <div class="import-export-buttons svelte-g40i6i"><!></div></div></div>');function ve(g,s){It(s,!0);const n=yt();let i=j(at(s.data.folderPath)),m=j(at(s.data.scriptActionId&&s.data.scriptActionId.trim()!==""?"completed":"pending")),S=j(!1),V=j(!1),x=j("pending"),I=j(""),z=j(at(s.data.folderPath));const Z=[{label:"Add your songs",href:"/song"},{label:"Create setlists",href:"/"}],A=[{label:'Open Reaper and go to "Actions" > "Show Action List".'},{label:"If you installed this via ReaPack, the reaper-setlist.lua script should already be listed here."},{label:'If not, click "New Action" > "Load ReaScript..." and open the reaper-setlist.lua script.'},{label:"Simply run the script to register it."},{label:"Use the refresh button below to check installation status."},{label:"Enter the root folder path where your backing tracks are stored in the form below."},{label:'Click "Save" to store these settings.'}];pt(()=>{!e(V)&&e(m)!=="completed"&&(o(V,!0),k())}),pt(()=>{e(i)!==e(z)&&e(x)!=="pending"&&(o(x,"pending"),o(I,""))});async function P(t){var _;t.preventDefault();let a=(((_=new FormData(t.target).get("backing-tracks-folder"))==null?void 0:_.toString())||"").replaceAll("\\","/");for(;a.includes("//");)a=a.replace("//","/");o(x,"checking"),o(I,"Validating folder..."),o(i,a,!0),o(z,a,!0);try{const f=await n.script.testProjectsFolder(a);if(!f.valid){o(x,"error"),o(I,f.message||"Invalid folder path. Please check the path and try again.",!0);return}await U.updateFolderPath(a),o(x,"success"),o(I,f.message||"Folder path is valid!",!0),E.success("Settings saved successfully!")}catch(f){o(x,"error"),o(I,`Error: ${f.message}`),E.error(`Failed to save settings: ${f.message}`);return}}async function k(){if(!e(S)){o(S,!0),o(m,"running");try{const t=await n.scriptSettings.getScriptActionId();if(t&&t.trim()!==""){U.reset(),await U.initialize(fetch);const $=$t();await n.script.testActionId($)===`Test action ID received: ${t}`?o(m,"completed"):o(m,"error"),o(m,"completed")}else o(m,"error")}catch(t){console.error("Error checking script installation:",t),o(m,"error")}finally{o(S,!1)}}}async function y(){const t=await n.songs.list(),$=await n.sets.list(),a=JSON.stringify({songs:t,sets:$},null,2),_=new Blob([a],{type:"application/json"}),f=URL.createObjectURL(_),w=document.createElement("a");w.href=f,w.download="reaper-setlist-data.json",document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(f),E.success("Data exported successfully!")}async function R(){const t=document.createElement("input");t.type="file",t.accept=".json",t.onchange=async $=>{const l=$.target;if(l.files&&l.files.length>0){const a=l.files[0];try{const _=await a.text(),f=JSON.parse(_),w=new Map;for(const L of Object.values(f.songs)){const{id:M,...W}=L,u=await n.songs.add(W);w.set(M,u.id)}for(const L of Object.values(f.sets)){const{...M}=L,W={...M,songs:L.songs.map(u=>w.get(u)||u)};await n.sets.add(W)}E.success("Data imported successfully!")}catch(_){E.error(`Failed to import data: ${_.message}`)}}},t.click()}async function J(){try{await n.script.exportRecordings(),E.success("Recording export started! Check Reaper for progress.")}catch(t){E.error(`Failed to start export: ${t.message}`)}}var T=ee(),B=b(p(T),2);{var d=t=>{ft(t,{title:"Script Installation",get steps(){return A},variant:"help",listType:"ordered"})},c=t=>{ft(t,{title:"Next steps:",get steps(){return Z},variant:"success",listType:"unordered"})};N(B,t=>{e(m)==="error"?t(d):t(c,!1)})}var C=b(B,2),ot=p(C);{let t=Rt(()=>e(m)==="completed"?"Script is installed and ready to use":e(m)==="running"?"Checking installation status...":"Script not detected. Please install the script in Reaper and refresh.");Tt(ot,{title:"Script Installation Status",get description(){return e(t)},get status(){return e(m)}})}var gt=b(ot,2);G(gt,{elementType:"button",onclick:k,get disabled(){return e(S)},variant:"text",children:(t,$)=>{var l=Gt(),a=O(l);Jt(a,{}),K(),r(t,l)},$$slots:{default:!0}}),v(C);var it=b(C,2);Dt(it,{onsubmit:P,children:(t,$)=>{var l=Xt(),a=O(l),_=b(p(a),2);kt(_);var f=b(_,2);{var w=u=>{var D=Kt(),q=p(D,!0);v(D),F(()=>{rt(D,1,`validation-message validation-message--${e(x)??""}`,"svelte-g40i6i"),H(q,e(I))}),r(u,D)},L=u=>{var D=St(),q=O(D);{var bt=et=>{var xt=Qt();r(et,xt)};N(q,et=>{e(i)&&e(i).trim()!==""&&e(i)!==e(z)&&et(bt)},!0)}r(u,D)};N(f,u=>{e(I)?u(w):u(L,!1)})}v(a);var M=b(a,2),W=p(M);G(W,{elementType:"submit",color:"success",children:(u,D)=>{K();var q=st("Save");r(u,q)},$$slots:{default:!0}}),v(M),F(()=>rt(_,1,wt(e(x)==="success"?"success":e(x)==="warning"?"warning":e(x)==="error"?"error":""))),At(_,()=>e(i),u=>o(i,u)),r(t,l)},$$slots:{default:!0}});var tt=b(it,2),lt=b(p(tt),2),nt=p(lt);G(nt,{elementType:"button",onclick:y,variant:"text",children:(t,$)=>{var l=Yt(),a=O(l);Ht(a,{}),K(),r(t,l)},$$slots:{default:!0}});var mt=b(nt,2);G(mt,{elementType:"button",onclick:R,variant:"text",children:(t,$)=>{var l=Zt(),a=O(l);Nt(a,{}),K(),r(t,l)},$$slots:{default:!0}}),v(lt),v(tt);var ct=b(tt,2),vt=b(p(ct),2),_t=p(vt);G(_t,{elementType:"button",onclick:J,variant:"text",children:(t,$)=>{var l=te(),a=O(l);qt(a,{}),K(),r(t,l)},$$slots:{default:!0}}),v(vt),v(ct),v(T),r(g,T),Pt()}export{ve as component,ce as universal};
