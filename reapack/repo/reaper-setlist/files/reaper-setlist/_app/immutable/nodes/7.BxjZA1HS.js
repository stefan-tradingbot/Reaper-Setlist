import{k as T,c as _t,e as xt,l as Tt,a as X,g as Yt,B as z,m as Zt,r as gt,o as te,n as C,p as ee,i as re}from"../chunks/cs0qqntR.js";import{f as p,s as Q,a,t as ct,b as Y,d as ae}from"../chunks/BzJ4SX3Z.js";import{c as d,r as n,s as h,t as W,l as t,p as se,q as S,k as lt,v as mt,a as oe,o as r,m as It,f as J,n as L}from"../chunks/CK57Ve49.js";import{p as At,i as M,r as Z}from"../chunks/_0x7LJxc.js";import{a as zt}from"../chunks/DgwUmPXI.js";import{F as le}from"../chunks/CuEdYIVd.js";import{S as ie}from"../chunks/D4bHquZa.js";const ne=async({fetch:g})=>{try{return await T.ensureInitialized(g),{folderPath:T.folderPath||"",scriptActionId:T.scriptActionId||""}}catch(o){return{folderPath:"",scriptActionId:"",error:o instanceof Error?o.message:"An unknown error occurred."}}},tr=Object.freeze(Object.defineProperty({__proto__:null,load:ne},Symbol.toStringTag,{value:"Module"}));var ce=p('<a class="svelte-kzvegf"> </a>'),ve=p('<li class="svelte-kzvegf"><!></li>'),de=p('<ol class="svelte-kzvegf"></ol>'),pe=p('<a class="svelte-kzvegf"> </a>'),fe=p('<li class="svelte-kzvegf"><!></li>'),ue=p('<ul class="svelte-kzvegf"></ul>'),he=p('<div><h2 class="svelte-kzvegf"> </h2> <!></div>');function Et(g,o){let i=At(o,"variant",3,"default"),s=At(o,"listType",3,"unordered");const $={default:"instruction-box--default",success:"instruction-box--success",info:"instruction-box--info",help:"instruction-box--help"};var E=he(),tt=d(E),k=d(tt,!0);n(tt);var F=h(tt,2);{var rt=O=>{var R=de();xt(R,21,()=>o.steps,I=>I.label,(I,P)=>{var V=ve(),D=d(V);{var q=f=>{var l=ce(),at=d(l,!0);n(l),W(()=>{Tt(l,"href",`#${t(P).href}`),Q(at,t(P).label)}),a(f,l)},B=f=>{var l=ct();W(()=>Q(l,t(P).label)),a(f,l)};M(D,f=>{t(P).href?f(q):f(B,!1)})}n(V),a(I,V)}),n(R),a(O,R)},vt=O=>{var R=ue();xt(R,21,()=>o.steps,I=>I.label,(I,P)=>{var V=fe(),D=d(V);{var q=f=>{var l=pe(),at=d(l,!0);n(l),W(()=>{Tt(l,"href",`#${t(P).href}`),Q(at,t(P).label)}),a(f,l)},B=f=>{var l=ct();W(()=>Q(l,t(P).label)),a(f,l)};M(D,f=>{t(P).href?f(q):f(B,!1)})}n(V),a(I,V)}),n(R),a(O,R)};M(F,O=>{s()==="ordered"?O(rt):O(vt,!1)})}n(E),W(()=>{_t(E,1,`instruction-box ${$[i()]??""}`,"svelte-kzvegf"),Q(k,o.title)}),a(g,E)}var ge=Y('<svg><path fill="currentColor" d="m23 12l-4-4v3h-9v2h9v3M1 18V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v3h-2V6H3v12h12v-3h2v3a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2"></path></svg>');function me(g,o){const i=Z(o,["$$slots","$$events","$$legacy"]);var s=ge();X(s,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...i})),a(g,s)}var _e=Y('<svg><path fill="currentColor" d="m14 12l-4-4v3H2v2h8v3m10 2V6a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v3h2V6h12v12H6v-3H4v3a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2"></path></svg>');function xe(g,o){const i=Z(o,["$$slots","$$events","$$legacy"]);var s=_e();X(s,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...i})),a(g,s)}var we=Y('<svg><path fill="currentColor" d="M17.65 6.35A7.96 7.96 0 0 0 12 4a8 8 0 0 0-8 8a8 8 0 0 0 8 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0 1 12 18a6 6 0 0 1-6-6a6 6 0 0 1 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"></path></svg>');function be(g,o){const i=Z(o,["$$slots","$$events","$$legacy"]);var s=we();X(s,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...i})),a(g,s)}var $e=Y('<svg><path fill="currentColor" d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2m0 2a8 8 0 0 1 8 8a8 8 0 0 1-8 8a8 8 0 0 1-8-8a8 8 0 0 1 8-8m0 5a3 3 0 0 0-3 3a3 3 0 0 0 3 3a3 3 0 0 0 3-3a3 3 0 0 0-3-3"></path></svg>');function Ft(g,o){const i=Z(o,["$$slots","$$events","$$legacy"]);var s=$e();X(s,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...i})),a(g,s)}var ke=Y('<svg><path fill="currentColor" d="M19 20H4a2 2 0 0 1-2-2V6c0-1.11.89-2 2-2h6l2 2h7a2 2 0 0 1 2 2H4v10l2.14-8h17.07l-2.28 8.5c-.23.87-1.01 1.5-1.93 1.5"></path></svg>');function ye(g,o){const i=Z(o,["$$slots","$$events","$$legacy"]);var s=ke();X(s,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...i})),a(g,s)}var Se=Y('<svg><path fill="currentColor" d="M22 16a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V4c0-1.11.89-2 2-2h12a2 2 0 0 1 2 2zm-6 4v2H4a2 2 0 0 1-2-2V7h2v13zm-3-6l7-7l-1.41-1.41L13 11.17L9.91 8.09L8.5 9.5z"></path></svg>');function Pe(g,o){const i=Z(o,["$$slots","$$events","$$legacy"]);var s=Se();X(s,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...i})),a(g,s)}var Ce=Y('<svg><path fill="currentColor" d="M20 16V4H8v12zm2 0a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V4c0-1.11.89-2 2-2h12a2 2 0 0 1 2 2zm-6 4v2H4a2 2 0 0 1-2-2V7h2v13z"></path></svg>');function Te(g,o){const i=Z(o,["$$slots","$$events","$$legacy"]);var s=Ce();X(s,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...i})),a(g,s)}var Ie=p("<!> Refresh Status",1),Ae=p("<div> </div>"),ze=p('<div class="validation-message validation-message--pending svelte-16rrxwf">Click "Save" to validate this folder path</div>'),Ee=p('<div class="form-group"><label for="backing-tracks-folder">Backing Tracks Root Folder:</label> <input type="text" id="backing-tracks-folder" name="backing-tracks-folder" placeholder="e.g., /path/to/your/backing/tracks"/> <!></div> <div class="submit-section"><!></div>',1),Fe=p("<!> Export Data",1),Re=p("<!> Import Data",1),Ve=p("<!> Select All",1),De=p("<!> None",1),Be=p('<div class="loading-tracks svelte-16rrxwf">Loading tracks from Reaper...</div>'),He=p('<div class="no-tracks svelte-16rrxwf">No tracks found in open projects.</div>'),je=(g,o,i)=>o(t(i)),Le=p('<label class="track-checkbox svelte-16rrxwf"><input type="checkbox" class="svelte-16rrxwf"/> <span class="track-name svelte-16rrxwf"> </span></label>'),Me=p('<div class="track-list svelte-16rrxwf"></div>'),Oe=p("<!> Start Export",1),Ne=p('<div class="export-form svelte-16rrxwf"><div class="form-group"><label for="export-path">Export Path:</label> <div class="path-input-group svelte-16rrxwf"><input type="text" id="export-path" placeholder="e.g., /path/to/export/folder" class="svelte-16rrxwf"/> <!></div></div> <div class="form-group"><div class="track-list-header svelte-16rrxwf"><label class="svelte-16rrxwf">Select Tracks to Export:</label> <div class="track-actions svelte-16rrxwf"><!> <!></div></div> <!></div> <div class="export-actions svelte-16rrxwf"><!> <!></div></div>'),Ue=p("<!> Configure Export",1),Je=p('<div class="import-export-buttons svelte-16rrxwf"><!></div>'),We=p('<div class="content svelte-16rrxwf"><h1>Setup</h1> <!> <div class="script-status svelte-16rrxwf"><!> <!></div> <!> <div class="import-export svelte-16rrxwf"><h3>Data Management</h3> <div class="import-export-buttons svelte-16rrxwf"><!> <!></div></div> <div class="import-export svelte-16rrxwf"><h3>Recording Export</h3> <!></div></div>');function er(g,o){se(o,!0);const i=Yt();let s=S(lt(o.data.folderPath)),$=S(lt(o.data.scriptActionId&&o.data.scriptActionId.trim()!==""?"completed":"pending")),E=S(!1),tt=S(!1),k=S("pending"),F=S(""),rt=S(lt(o.data.folderPath));const vt=[{label:"Add your songs",href:"/song"},{label:"Create setlists",href:"/"}],O=[{label:'Open Reaper and go to "Actions" > "Show Action List".'},{label:"If you installed this via ReaPack, the reaper-setlist.lua script should already be listed here."},{label:'If not, click "New Action" > "Load ReaScript..." and open the reaper-setlist.lua script.'},{label:"Simply run the script to register it."},{label:"Use the refresh button below to check installation status."},{label:"Enter the root folder path where your backing tracks are stored in the form below."},{label:'Click "Save" to store these settings.'}];mt(()=>{!t(tt)&&t($)!=="completed"&&(r(tt,!0),I())}),mt(()=>{t(s)!==t(rt)&&t(k)!=="pending"&&(r(k,"pending"),r(F,""))});async function R(e){var _;e.preventDefault();let c=(((_=new FormData(e.target).get("backing-tracks-folder"))==null?void 0:_.toString())||"").replaceAll("\\","/");for(;c.includes("//");)c=c.replace("//","/");r(k,"checking"),r(F,"Validating folder..."),r(s,c,!0),r(rt,c,!0);try{const m=await i.script.testProjectsFolder(c);if(!m.valid){r(k,"error"),r(F,m.message||"Invalid folder path. Please check the path and try again.",!0);return}await T.updateFolderPath(c),r(k,"success"),r(F,m.message||"Folder path is valid!",!0),C.success("Settings saved successfully!")}catch(m){r(k,"error"),r(F,`Error: ${m.message}`),C.error(`Failed to save settings: ${m.message}`);return}}async function I(){if(!t(E)){r(E,!0),r($,"running");try{const e=await i.scriptSettings.getScriptActionId();if(e&&e.trim()!==""){T.reset(),await T.initialize(fetch);const u=Zt();await i.script.testActionId(u)===`Test action ID received: ${e}`?r($,"completed"):r($,"error"),r($,"completed")}else r($,"error")}catch(e){console.error("Error checking script installation:",e),r($,"error")}finally{r(E,!1)}}}async function P(){const e=await i.songs.list(),u=await i.sets.list(),c=JSON.stringify({songs:e,sets:u},null,2),_=new Blob([c],{type:"application/json"}),m=URL.createObjectURL(_),b=document.createElement("a");b.href=m,b.download="reaper-setlist-data.json",document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(m),C.success("Data exported successfully!")}async function V(){const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=async u=>{const v=u.target;if(v.files&&v.files.length>0){const c=v.files[0];try{const _=await c.text(),m=JSON.parse(_),b=new Map;for(const A of Object.values(m.songs)){const{id:H,...N}=A,w=await i.songs.add(N);b.set(H,w.id)}for(const A of Object.values(m.sets)){const{...H}=A,N={...H,songs:A.songs.map(w=>b.get(w)||w)};await i.sets.add(N)}C.success("Data imported successfully!")}catch(_){C.error(`Failed to import data: ${_.message}`)}}},e.click()}let D=S(!1),q=S(!1),B=S(lt([])),f=S(lt(new Set)),l=S("");mt(()=>{!t(l)&&T.exportPath&&r(l,T.exportPath,!0)});async function at(){r(D,!0),r(q,!0);try{r(B,await i.script.getTrackNames(),!0),r(f,new Set(t(B)),!0),t(l)||r(l,T.exportPath||t(s)||"",!0)}catch(e){C.error(`Failed to fetch tracks: ${e.message}`),r(D,!1)}finally{r(q,!1)}}function Rt(e){const u=new Set(t(f));u.has(e)?u.delete(e):u.add(e),r(f,u,!0)}function Vt(){r(f,new Set(t(B)),!0)}function Dt(){r(f,new Set,!0)}async function Bt(){try{const e=await i.script.browseFolder(t(l)||t(s)||"/");e&&e.trim()!==""&&(r(l,e,!0),await T.updateExportPath(t(l)))}catch(e){C.error(`Failed to open folder browser: ${e.message}`)}}async function Ht(){if(t(f).size===0){C.error("Please select at least one track.");return}if(!t(l)){C.error("Please enter an export path.");return}try{await T.updateExportPath(t(l)),await i.script.exportRecordings(Array.from(t(f)),t(l)),C.success("Recording export started! Check Reaper for progress."),r(D,!1)}catch(e){C.error(`Failed to start export: ${e.message}`)}}var dt=We(),wt=h(d(dt),2);{var jt=e=>{Et(e,{title:"Script Installation",get steps(){return O},variant:"help",listType:"ordered"})},Lt=e=>{Et(e,{title:"Next steps:",get steps(){return vt},variant:"success",listType:"unordered"})};M(wt,e=>{t($)==="error"?e(jt):e(Lt,!1)})}var pt=h(wt,2),bt=d(pt);const Mt=It(()=>t($)==="completed"?"Script is installed and ready to use":t($)==="running"?"Checking installation status...":"Script not detected. Please install the script in Reaper and refresh.");ie(bt,{title:"Script Installation Status",get description(){return t(Mt)},get status(){return t($)}});var Ot=h(bt,2);z(Ot,{elementType:"button",onclick:I,get disabled(){return t(E)},variant:"text",children:(e,u)=>{var v=Ie(),c=J(v);be(c,{}),L(),a(e,v)},$$slots:{default:!0}}),n(pt);var $t=h(pt,2);le($t,{onsubmit:R,children:(e,u)=>{var v=Ee(),c=J(v),_=h(d(c),2);gt(_);var m=h(_,2);{var b=w=>{var j=Ae(),G=d(j,!0);n(j),W(()=>{_t(j,1,`validation-message validation-message--${t(k)??""}`,"svelte-16rrxwf"),Q(G,t(F))}),a(w,j)},A=(w,j)=>{{var G=st=>{var it=ze();a(st,it)};M(w,st=>{t(s)&&t(s).trim()!==""&&t(s)!==t(rt)&&st(G)},j)}};M(m,w=>{t(F)?w(b):w(A,!1)})}n(c);var H=h(c,2),N=d(H);z(N,{elementType:"submit",color:"success",children:(w,j)=>{L();var G=ct("Save");a(w,G)},$$slots:{default:!0}}),n(H),W(()=>_t(_,1,te(t(k)==="success"?"success":t(k)==="warning"?"warning":t(k)==="error"?"error":""))),zt(_,()=>t(s),w=>r(s,w)),a(e,v)},$$slots:{default:!0}});var ft=h($t,2),kt=h(d(ft),2),yt=d(kt);z(yt,{elementType:"button",onclick:P,variant:"text",children:(e,u)=>{var v=Fe(),c=J(v);me(c,{}),L(),a(e,v)},$$slots:{default:!0}});var Nt=h(yt,2);z(Nt,{elementType:"button",onclick:V,variant:"text",children:(e,u)=>{var v=Re(),c=J(v);xe(c,{}),L(),a(e,v)},$$slots:{default:!0}}),n(kt),n(ft);var St=h(ft,2),Ut=h(d(St),2);{var Jt=e=>{var u=Ne(),v=d(u),c=h(d(v),2),_=d(c);gt(_);var m=h(_,2);z(m,{variant:"secondary",onclick:Bt,title:"Browse Folder",children:(x,U)=>{ye(x,{})},$$slots:{default:!0}}),n(c),n(v);var b=h(v,2),A=d(b),H=h(d(A),2),N=d(H);z(N,{elementType:"button",variant:"text",onclick:Vt,title:"Select All",children:(x,U)=>{var y=Ve(),K=J(y);Pe(K,{}),L(),a(x,y)},$$slots:{default:!0}});var w=h(N,2);z(w,{elementType:"button",variant:"text",onclick:Dt,title:"Deselect All",children:(x,U)=>{var y=De(),K=J(y);Te(K,{}),L(),a(x,y)},$$slots:{default:!0}}),n(H),n(A);var j=h(A,2);{var G=x=>{var U=Be();a(x,U)},st=(x,U)=>{{var y=et=>{var ot=He();a(et,ot)},K=et=>{var ot=Me();xt(ot,21,()=>t(B),re,(Kt,ut)=>{var ht=Le(),nt=d(ht);gt(nt),nt.__change=[je,Rt,ut];var Ct=h(nt,2),Qt=d(Ct,!0);n(Ct),n(ht),W(Xt=>{ee(nt,Xt),Q(Qt,t(ut))},[()=>t(f).has(t(ut))]),a(Kt,ht)}),n(ot),a(et,ot)};M(x,et=>{t(B).length===0?et(y):et(K,!1)},U)}};M(j,x=>{t(q)?x(G):x(st,!1)})}n(b);var it=h(b,2),Pt=d(it);const qt=It(()=>t(f).size===0||!t(l));z(Pt,{elementType:"button",onclick:Ht,get disabled(){return t(qt)},children:(x,U)=>{var y=Oe(),K=J(y);Ft(K,{}),L(),a(x,y)},$$slots:{default:!0}});var Gt=h(Pt,2);z(Gt,{elementType:"button",variant:"text",onclick:()=>r(D,!1),children:(x,U)=>{L();var y=ct("Cancel");a(x,y)},$$slots:{default:!0}}),n(it),n(u),zt(_,()=>t(l),x=>r(l,x)),a(e,u)},Wt=e=>{var u=Je(),v=d(u);z(v,{elementType:"button",onclick:at,variant:"text",children:(c,_)=>{var m=Ue(),b=J(m);Ft(b,{}),L(),a(c,m)},$$slots:{default:!0}}),n(u),a(e,u)};M(Ut,e=>{t(D)?e(Jt):e(Wt,!1)})}n(St),n(dt),a(g,dt),oe()}ae(["change"]);export{er as component,tr as universal};
