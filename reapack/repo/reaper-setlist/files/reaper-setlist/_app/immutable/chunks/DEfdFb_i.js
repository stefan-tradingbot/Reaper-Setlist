var de=Object.defineProperty;var Pt=s=>{throw TypeError(s)};var he=(s,t,e)=>t in s?de(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var M=(s,t,e)=>he(s,typeof t!="symbol"?t+"":t,e),pe=(s,t,e)=>t.has(s)||Pt("Cannot "+e);var V=(s,t,e)=>(pe(s,t,"read from private field"),e?e.call(s):t.get(s)),ft=(s,t,e)=>t.has(s)?Pt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,e);import{d as nt,m as L,a0 as me,Q as ve,g as st,M as Jt,N as W,a9 as ge,ad as kt,h as A,J as qt,L as we,aK as it,aL as dt,aE as Yt,K as $,aM as ot,aN as Se,aA as Ce,aO as _e,aD as ye,aP as Re,b as Te,aQ as Wt,z as be,R as xe,S as Ee,U as Nt,V as ht,W as q,O as H,af as Ae,aG as Ie,at as Pe,aR as $t,I as Zt,am as Ot,aS as ke,E as Ne,C as Rt,l as Oe,as as Me,aT as Le,aU as je,j as De,aV as Ke,aW as ze,aX as Fe,aY as Ue,aZ as Be,a_ as Ve,a$ as He,b0 as Ge,b1 as Xe,o as rt,k as Qt,v as U,p as Je,f as Mt,a as qe,c as Lt,y as jt,r as Dt,t as Kt,n as Ye}from"./BWSO7Bi6.js";import{i as We,j as $e,d as te,n as Ze,k as Qe,b as ts,a as J,c as zt,f as ee}from"./B_oGNvez.js";import{B as es,r as ss,p as rs,i as Ft,b as Ut}from"./DnK7exoB.js";let pt=null;function qs(s,t){return t}function as(s,t,e){for(var r=s.items,a=[],n=t.length,i=0;i<n;i++)_e(t[i].e,a,!0);var o=n>0&&a.length===0&&e!==null;if(o){var f=e.parentNode;ye(f),f.append(e),r.clear(),j(s,t[0].prev,t[n-1].next)}Re(a,()=>{for(var m=0;m<n;m++){var v=t[m];o||(r.delete(v.k),j(s,v.prev,v.next)),$(v.e,!o)}})}function Ys(s,t,e,r,a,n=null){var i=s,o={flags:t,items:new Map,first:null},f=(t&$t)!==0;if(f){var m=s;i=A?ht(Pe(m)):m.appendChild(Jt())}A&&Te();var v=null,S=!1,h=new Map,y=me(()=>{var p=e();return Wt(p)?p:p==null?[]:Yt(p)}),c,w;function d(){ns(w,c,o,h,i,a,t,r,e),n!==null&&(c.length===0?v?qt(v):v=W(()=>n(i)):v!==null&&we(v,()=>{v=null}))}nt(()=>{w??(w=be),c=L(y);var p=c.length;if(S&&p===0)return;S=p===0;let E=!1;if(A){var R=xe(i)===Ee;R!==(p===0)&&(i=Nt(),ht(i),q(!1),E=!0)}if(A){for(var C=null,T,l=0;l<p;l++){if(H.nodeType===Ae&&H.data===Ie){i=H,E=!0,q(!1);break}var u=c[l],g=r(u,l);T=Ct(H,o,C,null,u,g,l,a,t,e),o.items.set(g,T),C=T}p>0&&ht(Nt())}if(A)p===0&&n&&(v=W(()=>n(i)));else if(ve()){var P=new Set,x=st;for(l=0;l<p;l+=1){u=c[l],g=r(u,l);var D=o.items.get(g)??h.get(g);D?(t&(ot|it))!==0&&se(D,u,l,t):(T=Ct(null,o,null,null,u,g,l,a,t,e,!0),h.set(g,T)),P.add(g)}for(const[k,tt]of o.items)P.has(k)||x.skipped_effects.add(tt.e);x.oncommit(d)}else d();E&&q(!0),L(y)}),A&&(i=H)}function ns(s,t,e,r,a,n,i,o,f){var bt,xt,Et,At;var m=(i&ke)!==0,v=(i&(ot|it))!==0,S=t.length,h=e.items,y=e.first,c=y,w,d=null,p,E=[],R=[],C,T,l,u;if(m)for(u=0;u<S;u+=1)C=t[u],T=o(C,u),l=h.get(T),l!==void 0&&((bt=l.a)==null||bt.measure(),(p??(p=new Set)).add(l));for(u=0;u<S;u+=1){if(C=t[u],T=o(C,u),l=h.get(T),l===void 0){var g=r.get(T);if(g!==void 0){r.delete(T),h.set(T,g);var P=d?d.next:c;j(e,d,g),j(e,g,P),mt(g,P,a),d=g}else{var x=c?c.e.nodes_start:a;d=Ct(x,e,d,d===null?e.first:d.next,C,T,u,n,i,f)}h.set(T,d),E=[],R=[],c=d.next;continue}if(v&&se(l,C,u,i),(l.e.f&dt)!==0&&(qt(l.e),m&&((xt=l.a)==null||xt.unfix(),(p??(p=new Set)).delete(l))),l!==c){if(w!==void 0&&w.has(l)){if(E.length<R.length){var D=R[0],k;d=D.prev;var tt=E[0],lt=E[E.length-1];for(k=0;k<E.length;k+=1)mt(E[k],D,a);for(k=0;k<R.length;k+=1)w.delete(R[k]);j(e,tt.prev,lt.next),j(e,d,tt),j(e,lt,D),c=D,d=lt,u-=1,E=[],R=[]}else w.delete(l),mt(l,c,a),j(e,l.prev,l.next),j(e,l,d===null?e.first:d.next),j(e,d,l),d=l;continue}for(E=[],R=[];c!==null&&c.k!==T;)(c.e.f&dt)===0&&(w??(w=new Set)).add(c),R.push(c),c=c.next;if(c===null)continue;l=c}E.push(l),d=l,c=l.next}if(c!==null||w!==void 0){for(var B=w===void 0?[]:Yt(w);c!==null;)(c.e.f&dt)===0&&B.push(c),c=c.next;var ut=B.length;if(ut>0){var ue=(i&$t)!==0&&S===0?a:null;if(m){for(u=0;u<ut;u+=1)(Et=B[u].a)==null||Et.measure();for(u=0;u<ut;u+=1)(At=B[u].a)==null||At.fix()}as(e,B,ue)}}m&&Zt(()=>{var It;if(p!==void 0)for(l of p)(It=l.a)==null||It.apply()}),s.first=e.first&&e.first.e,s.last=d&&d.e;for(var fe of r.values())$(fe.e);r.clear()}function se(s,t,e,r){(r&ot)!==0&&Ot(s.v,t),(r&it)!==0?Ot(s.i,e):s.i=e}function Ct(s,t,e,r,a,n,i,o,f,m,v){var S=pt,h=(f&ot)!==0,y=(f&Se)===0,c=h?y?ge(a,!1,!1):kt(a):a,w=(f&it)===0?i:kt(i),d={i:w,v:c,k:n,a:null,e:null,prev:e,next:r};pt=d;try{if(s===null){var p=document.createDocumentFragment();p.append(s=Jt())}return d.e=W(()=>o(s,c,w,m),A),d.e.prev=e&&e.e,d.e.next=r&&r.e,e===null?v||(t.first=d):(e.next=d,e.e.next=d.e),r!==null&&(r.prev=d,r.e.prev=d.e),d}finally{pt=S}}function mt(s,t,e){for(var r=s.next?s.next.e.nodes_start:e,a=t?t.e.nodes_start:e,n=s.e.nodes_start;n!==null&&n!==r;){var i=Ce(n);a.before(n),n=i}}function j(s,t,e){t===null?s.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}function Bt(s,t,...e){var r=new es(s);nt(()=>{const a=t()??null;r.ensure(a,a&&(n=>a(n,...e)))},Ne)}function is(s,t){var e=void 0,r;nt(()=>{e!==(e=t())&&(r&&($(r),r=null),e&&(r=W(()=>{Rt(()=>e(s))})))})}function re(s){var t,e,r="";if(typeof s=="string"||typeof s=="number")r+=s;else if(typeof s=="object")if(Array.isArray(s)){var a=s.length;for(t=0;t<a;t++)s[t]&&(e=re(s[t]))&&(r&&(r+=" "),r+=e)}else for(e in s)s[e]&&(r&&(r+=" "),r+=e);return r}function os(){for(var s,t,e=0,r="",a=arguments.length;e<a;e++)(s=arguments[e])&&(t=re(s))&&(r&&(r+=" "),r+=t);return r}function cs(s){return typeof s=="object"?os(s):s??""}const Vt=[...` 	
\r\fÂ \v\uFEFF`];function ls(s,t,e){var r=s==null?"":""+s;if(t&&(r=r?r+" "+t:t),e){for(var a in e)if(e[a])r=r?r+" "+a:a;else if(r.length)for(var n=a.length,i=0;(i=r.indexOf(a,i))>=0;){var o=i+n;(i===0||Vt.includes(r[i-1]))&&(o===r.length||Vt.includes(r[o]))?r=(i===0?"":r.substring(0,i))+r.substring(o+1):i=o}}return r===""?null:r}function Ht(s,t=!1){var e=t?" !important;":";",r="";for(var a in s){var n=s[a];n!=null&&n!==""&&(r+=" "+a+": "+n+e)}return r}function vt(s){return s[0]!=="-"||s[1]!=="-"?s.toLowerCase():s}function us(s,t){if(t){var e="",r,a;if(Array.isArray(t)?(r=t[0],a=t[1]):r=t,s){s=String(s).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var n=!1,i=0,o=!1,f=[];r&&f.push(...Object.keys(r).map(vt)),a&&f.push(...Object.keys(a).map(vt));var m=0,v=-1;const w=s.length;for(var S=0;S<w;S++){var h=s[S];if(o?h==="/"&&s[S-1]==="*"&&(o=!1):n?n===h&&(n=!1):h==="/"&&s[S+1]==="*"?o=!0:h==='"'||h==="'"?n=h:h==="("?i++:h===")"&&i--,!o&&n===!1&&i===0){if(h===":"&&v===-1)v=S;else if(h===";"||S===w-1){if(v!==-1){var y=vt(s.substring(m,v).trim());if(!f.includes(y)){h!==";"&&S++;var c=s.substring(m,S).trim();e+=" "+c+";"}}m=S+1,v=-1}}}}return r&&(e+=Ht(r)),a&&(e+=Ht(a,!0)),e=e.trim(),e===""?null:e}return s==null?null:String(s)}function _t(s,t,e,r,a,n){var i=s.__className;if(A||i!==e||i===void 0){var o=ls(e,r,n);(!A||o!==s.getAttribute("class"))&&(o==null?s.removeAttribute("class"):t?s.className=o:s.setAttribute("class",o)),s.__className=e}else if(n&&a!==n)for(var f in n){var m=!!n[f];(a==null||m!==!!a[f])&&s.classList.toggle(f,m)}return n}function gt(s,t={},e,r){for(var a in e){var n=e[a];t[a]!==n&&(e[a]==null?s.style.removeProperty(a):s.style.setProperty(a,n,r))}}function yt(s,t,e,r){var a=s.__style;if(A||a!==t){var n=us(t,r);(!A||n!==s.getAttribute("style"))&&(n==null?s.removeAttribute("style"):s.style.cssText=n),s.__style=t}else r&&(Array.isArray(r)?(gt(s,e==null?void 0:e[0],r[0]),gt(s,e==null?void 0:e[1],r[1],"important")):gt(s,e,r));return r}function at(s,t,e=!1){if(s.multiple){if(t==null)return;if(!Wt(t))return Le();for(var r of s.options)r.selected=t.includes(Y(r));return}for(r of s.options){var a=Y(r);if(je(a,t)){r.selected=!0;return}}(!e||t!==void 0)&&(s.selectedIndex=-1)}function ae(s){var t=new MutationObserver(()=>{at(s,s.__value)});t.observe(s,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Me(()=>{t.disconnect()})}function Ws(s,t,e=t){var r=new WeakSet,a=!0;Oe(s,"change",n=>{var i=n?"[selected]":":checked",o;if(s.multiple)o=[].map.call(s.querySelectorAll(i),Y);else{var f=s.querySelector(i)??s.querySelector("option:not([disabled])");o=f&&Y(f)}e(o),st!==null&&r.add(st)}),Rt(()=>{var n=t();if(s===document.activeElement){var i=De??st;if(r.has(i))return}if(at(s,n,a),a&&n===void 0){var o=s.querySelector(":checked");o!==null&&(n=Y(o),e(n))}s.__value=n,a=!1}),ae(s)}function Y(s){return"__value"in s?s.__value:s.value}const G=Symbol("class"),X=Symbol("style"),ne=Symbol("is custom element"),ie=Symbol("is html");function fs(s){if(A){var t=!1,e=()=>{if(!t){if(t=!0,s.hasAttribute("value")){var r=s.value;F(s,"value",null),s.value=r}if(s.hasAttribute("checked")){var a=s.checked;F(s,"checked",null),s.checked=a}}};s.__on_r=e,Zt(e),He()}}function $s(s,t){var e=Tt(s);e.value===(e.value=t??void 0)||s.value===t&&(t!==0||s.nodeName!=="PROGRESS")||(s.value=t??"")}function ds(s,t){t?s.hasAttribute("selected")||s.setAttribute("selected",""):s.removeAttribute("selected")}function F(s,t,e,r){var a=Tt(s);A&&(a[t]=s.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&s.nodeName==="LINK")||a[t]!==(a[t]=e)&&(t==="loading"&&(s[Ge]=e),e==null?s.removeAttribute(t):typeof e!="string"&&oe(s).includes(t)?s[t]=e:s.setAttribute(t,e))}function hs(s,t,e,r,a=!1,n=!1){if(A&&a&&s.tagName==="INPUT"){var i=s,o=i.type==="checkbox"?"defaultChecked":"defaultValue";o in e||fs(i)}var f=Tt(s),m=f[ne],v=!f[ie];let S=A&&m;S&&q(!1);var h=t||{},y=s.tagName==="OPTION";for(var c in t)c in e||(e[c]=null);e.class?e.class=cs(e.class):e[G]&&(e.class=null),e[X]&&(e.style??(e.style=null));var w=oe(s);for(const l in e){let u=e[l];if(y&&l==="value"&&u==null){s.value=s.__value="",h[l]=u;continue}if(l==="class"){var d=s.namespaceURI==="http://www.w3.org/1999/xhtml";_t(s,d,u,r,t==null?void 0:t[G],e[G]),h[l]=u,h[G]=e[G];continue}if(l==="style"){yt(s,u,t==null?void 0:t[X],e[X]),h[l]=u,h[X]=e[X];continue}var p=h[l];if(!(u===p&&!(u===void 0&&s.hasAttribute(l)))){h[l]=u;var E=l[0]+l[1];if(E!=="$$")if(E==="on"){const g={},P="$$"+l;let x=l.slice(2);var R=Qe(x);if(We(x)&&(x=x.slice(0,-7),g.capture=!0),!R&&p){if(u!=null)continue;s.removeEventListener(x,h[P],g),h[P]=null}if(u!=null)if(R)s[`__${x}`]=u,te([x]);else{let D=function(k){h[l].call(this,k)};h[P]=$e(x,s,D,g)}else R&&(s[`__${x}`]=void 0)}else if(l==="style")F(s,l,u);else if(l==="autofocus")Be(s,!!u);else if(!m&&(l==="__value"||l==="value"&&u!=null))s.value=s.__value=u;else if(l==="selected"&&y)ds(s,u);else{var C=l;v||(C=Ze(C));var T=C==="defaultValue"||C==="defaultChecked";if(u==null&&!m&&!T)if(f[l]=null,C==="value"||C==="checked"){let g=s;const P=t===void 0;if(C==="value"){let x=g.defaultValue;g.removeAttribute(C),g.defaultValue=x,g.value=g.__value=P?x:null}else{let x=g.defaultChecked;g.removeAttribute(C),g.defaultChecked=x,g.checked=P?x:!1}}else s.removeAttribute(l);else T||w.includes(C)&&(m||typeof u!="string")?(s[C]=u,C in f&&(f[C]=Ve)):typeof u!="function"&&F(s,C,u)}}}return S&&q(!0),h}function ps(s,t,e=[],r=[],a=[],n,i=!1,o=!1){Fe(a,e,r,f=>{var m=void 0,v={},S=s.nodeName==="SELECT",h=!1;if(nt(()=>{var c=t(...f.map(L)),w=hs(s,m,c,n,i,o);h&&S&&"value"in c&&at(s,c.value);for(let p of Object.getOwnPropertySymbols(v))c[p]||$(v[p]);for(let p of Object.getOwnPropertySymbols(c)){var d=c[p];p.description===Ue&&(!m||d!==m[p])&&(v[p]&&$(v[p]),v[p]=W(()=>is(s,()=>d))),w[p]=d}m=w}),S){var y=s;Rt(()=>{at(y,m.value,!0),ae(y)})}h=!0})}function Tt(s){return s.__attributes??(s.__attributes={[ne]:s.nodeName.includes("-"),[ie]:s.namespaceURI===Ke})}var Gt=new Map;function oe(s){var t=s.getAttribute("is")||s.nodeName,e=Gt.get(t);if(e)return e;Gt.set(t,e=[]);for(var r,a=s,n=Element.prototype;n!==a;){r=Xe(a);for(var i in r)r[i].set&&e.push(i);a=ze(a)}return e}function Zs(s){const t=Math.floor(s/60),e=Math.floor(s%60);return`${t}:${e.toString().padStart(2,"0")}`}function ce(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const t=Math.random()*16|0;return(s==="x"?t:t&3|8).toString(16)})}var Z;class ms{constructor(){ft(this,Z,rt(Qt([])))}get notifications(){return L(V(this,Z))}set notifications(t){U(V(this,Z),t,!0)}get items(){return this.notifications}add(t,e="primary",r){const a=ce(),n={id:a,message:t,type:e,duration:r,timestamp:new Date};return this.notifications=[...this.notifications,n],r!==void 0&&setTimeout(()=>{this.remove(a)},r),a}remove(t){this.notifications=this.notifications.filter(e=>e.id!==t)}clear(){this.notifications=[]}success(t,e=5e3){return this.add(t,"success",e)}error(t,e){return this.add(t,"delete",e)}warning(t,e=7e3){return this.add(t,"edit",e)}info(t,e=5e3){return this.add(t,"primary",e)}}Z=new WeakMap;const Qs=new ms,vs="Operation",et={ProjectRoot:"ProjectRoot",ScriptActionId:"ScriptActionId"},b={ReaperSetlist:"ReaperSetlist",Songs:"ReaperSetlist.Songs",Sets:"ReaperSetlist.Sets"};class ct{}class gs extends ct{parseResponse(t){if(!t)throw new Error("Empty transport response");const e=t.split("	");if(e.length!==6)throw new Error(`Unexpected transport format: ${t}`);return{playState:parseInt(e[1],10),positionSeconds:parseFloat(e[2]),repeatOn:e[3]==="1",positionString:e[4],positionStringBeats:e[5]}}getResponseMarker(){return"TRANSPORT"}async getCommandString(){return Promise.resolve("TRANSPORT")}}class ws extends ct{parseResponse(t){const e=[];for(const r of t){if(r.startsWith("MARKER_LIST"))continue;if(r.startsWith("MARKER_LIST_END"))break;const a=r.split("	");if(a.length<4)throw new Error(`Invalid marker line: ${r}`);const n={id:parseInt(a[2],10),name:a[1],position:parseFloat(a[3])};e.push(n)}return e}getResponseMarker(){return"MARKER_LIST"}async getCommandString(){return Promise.resolve("MARKER")}}class I extends ct{parseResponse(t){}getResponseMarker(){}}class Ss extends I{getCommandString(){return Promise.resolve("40042")}}class Cs extends I{getCommandString(){return Promise.resolve("40859")}}class _s extends I{getCommandString(){return Promise.resolve("40860")}}class ys extends I{getCommandString(){return Promise.resolve("40886")}}class Rs extends I{getCommandString(){return Promise.resolve("40861")}}class Ts extends I{getCommandString(){return Promise.resolve("40862")}}class bs extends I{getCommandString(){return Promise.resolve("1007")}}class xs extends I{getCommandString(){return Promise.resolve("1008")}}class Es extends I{getCommandString(){return Promise.resolve("1016")}}class As extends I{getCommandString(){return Promise.resolve("1013")}}class K extends I{async getCommandString(){if(await St.ensureInitialized(),!St.scriptActionId)throw new Error("Script action ID is not set. Please configure it in the settings.");return St.scriptActionId}}class Is extends I{constructor(t){super(),this.markerId=t}async getCommandString(){return Promise.resolve(`SET/POS_STR/m${this.markerId}`)}}class N extends I{constructor(t,e,r,a=!1){super(),this.section=t,this.key=e,this.value=r,this.persist=a}async getCommandString(){const t=this.persist?"SET/EXTSTATEPERSIST":"SET/EXTSTATE",e=encodeURIComponent(this.value);return Promise.resolve(`${t}/${this.section}/${this.key}/${e}`)}}class z extends N{constructor(t){super(b.ReaperSetlist,vs,t,!1)}}class O extends ct{constructor(t,e,r=!0){super(),this.section=t,this.key=e,this.temp=r}getCommandString(){const t=this.temp?"GET/EXTSTATE":"GET/EXTSTATE_PERSIST";return Promise.resolve(`${t}/${this.section}/${this.key}`)}parseResponse(t){if(!t||t.trim()==="")return;const e=t.trim(),r=e.split("	");if(r.length===4&&r[0]==="EXTSTATE"&&r[1]===this.section&&r[2]===this.key)return r[3];if(r.length===3&&r[0]==="EXTSTATE"&&r[1]===this.section&&r[2]===this.key)return;throw new Error(`Unexpected response format: ${e}`)}getResponseMarker(){return"EXTSTATE"}}const _={transport:()=>new gs,markers:()=>new ws,goToStart:()=>new Ss,goToMarker:s=>new Is(s),newTab:()=>new Cs,closeTab:()=>new _s,closeAllTabs:()=>new ys,nextTab:()=>new Rs,previousTab:()=>new Ts,play:()=>new bs,pause:()=>new xs,stop:()=>new Es,record:()=>new As},Ps=600;class ks{constructor(t,e=globalThis.fetch){M(this,"urlRoot");M(this,"fetch");this.urlRoot=t,this.fetch=e}async executeCommand(t){const[e]=await this.executeCommands([t]);return e}async executeCommands(t){const e=await Promise.all(t.map(n=>n.getCommandString())),r=await this.sendRawCommands(e);return this.parseMultiCommandResponse(t,r)}parseMultiCommandResponse(t,e){const r=[];let a=0;for(const n of t){if(!n.getResponseMarker()){r.push(void 0);continue}const i=e[a];if(i.length===0)throw new Error(`Empty response for command: ${n.getCommandString()}`);const o=i.split("	")[0];if(o!==n.getResponseMarker())throw new Error(`Unexpected response type for command ${n.getCommandString()}: expected ${n.getResponseMarker()}, got ${o}`);if(n.getResponseMarker()==="MARKER_LIST"){const f=n.parseResponse(e.slice(a)),m=f;r.push(f),a+=m.length+1}else{const f=n.parseResponse(i);r.push(f)}a++}return r}async sendCommand(t){return this.sendRawCommand(t)}async sendCommands(t){return this.sendRawCommands(t)}async getTransport(){return this.executeCommand(_.transport())}async goToStart(){const[t,e]=await this.executeCommands([_.goToStart(),_.transport()]);return e}async play(){const[,t]=await this.executeCommands([_.play(),_.transport()]);return t}async pause(){const[,t]=await this.executeCommands([_.pause(),_.transport()]);return t}async stop(){const[,t]=await this.executeCommands([_.stop(),_.transport()]);return t}async record(){const[,t]=await this.executeCommands([_.record(),_.transport()]);return t}async closeTab(){await this.executeCommand(_.closeTab())}async newTab(){await this.executeCommand(_.newTab())}async closeAllTabs(){await this.executeCommand(_.closeAllTabs())}async nextTab(){const[,t,e]=await this.executeCommands([_.nextTab(),_.transport(),_.markers()]);return{markers:e,transport:t}}async previousTab(){const[,t,e]=await this.executeCommands([_.previousTab(),_.transport(),_.markers()]);return{markers:e,transport:t}}async getMarkers(){return this.executeCommand(_.markers())}async goToMarker(t){const[e,r]=await this.executeCommands([_.goToMarker(t),_.transport()]);return r}async playAndGetFullState(){const[t,e,r]=await this.executeCommands([_.play(),_.transport(),_.markers()]);return{playResult:t,transport:e,markers:r}}async sendRawCommand(t){const e=await this.fetch(`${this.urlRoot}/${t}`,{method:"GET"});if(!e.ok)throw new Error(`Failed to send command ${t}: ${e.statusText}`);return(await e.text()).split(`
`).filter(n=>n.trim()!=="")}async sendRawCommands(t){if(t.length===0)return[];const e=[],r=this.batchCommandsByUrlLength(t);for(const a of r){const n=`${this.urlRoot}/${a.join(";")}`,i=await this.fetch(n,{method:"GET"});if(!i.ok)throw new Error(`Failed to send commands ${a.join(",")}: ${i.statusText}`);const f=(await i.text()).split(`
`).slice(0,-1);e.push(...f)}return e}batchCommandsByUrlLength(t){const e=[];let r=[],a=this.urlRoot.length;for(const n of t){const o=(r.length>0?";":"").length+n.length;a+o>Ps&&r.length>0?(e.push([...r]),r=[n],a=this.urlRoot.length+n.length):(r.push(n),a+=o)}return r.length>0&&e.push(r),e}}class Ns{}const Os=500,wt="__index__";class le extends Ns{constructor(t,e,r){super(),this.apiClient=t,this.scriptClient=e,this.sectionKey=r}async fetchIndex(){const t=new O(this.sectionKey,wt),e=await this.apiClient.executeCommand(t);return e?JSON.parse(e):[]}async saveData(t,e){JSON.stringify(e).length<=Os?await this.apiClient.executeCommand(new N(this.sectionKey,t,JSON.stringify(e),!0)):await this.scriptClient.writeChunkedData(this.sectionKey,t,e)}async saveIndex(t){await this.saveData(wt,t)}async fetchById(t){const e=new O(this.sectionKey,t),r=await this.apiClient.executeCommand(e);return r?JSON.parse(r):void 0}async saveById(t,e){await this.saveData(t,e)}async deleteById(t){await this.scriptClient.deleteState(this.sectionKey,t)}async get(t){return this.fetchById(t)}async update(t,e){await this.saveById(t,e)}async add(t){const e=ce(),r={...t,id:e};await this.saveById(e,r);const a=await this.fetchIndex();return a.push(e),await this.saveIndex(a),r}async delete(t){await this.deleteById(t);const r=(await this.fetchIndex()).filter(a=>a!==t);await this.saveIndex(r)}async list(){const t=new O(this.sectionKey,wt),e=await this.apiClient.executeCommand(t);if(!e)return{};const r=JSON.parse(e),a={},n=r.map(o=>new O(this.sectionKey,o)),i=await this.apiClient.executeCommands(n);for(const o of i)if(o){const f=JSON.parse(o);a[f.id]=f}return a}}class Ms{constructor(t){this.apiClient=t}getChunkCommands(t,e){const r=[],a=JSON.stringify(e),n=500;for(let o=0;o<a.length;o+=n)r.push(a.slice(o,o+n));const i=[];i.push(new N(b.ReaperSetlist,`${t}_length`,r.length.toString()));for(let o=0;o<r.length;o++)i.push(new N(b.ReaperSetlist,`${t}_${o}`,r[o]));return i}async listProjects(){const t=[new z("listProjects"),new K,new O(b.ReaperSetlist,"projects")],[e,r,a]=await this.apiClient.executeCommands(t);if(a===void 0)throw new Error("Failed to retrieve projects. Please check the script configuration.");return JSON.parse(a)}async testProjectsFolder(t){const e=[new N(b.ReaperSetlist,"folderPath",t),new z("testProjectsFolder"),new K,new O(b.ReaperSetlist,"valid"),new O(b.ReaperSetlist,"message")],[r,a,n,i,o]=await this.apiClient.executeCommands(e);if(i===void 0)throw new Error("Failed to retrieve valid. Please check the script configuration.");const f=i==="true";if(o===void 0)throw new Error("Failed to retrieve message. Please check the script configuration.");return{valid:f,message:o}}async openProject(t){const e=[new N(b.ReaperSetlist,"projectPath",t),new z("openProject"),new K];await this.apiClient.executeCommands(e)}async testActionId(t){const e=[new N(b.ReaperSetlist,"testNonce",t),new z("testActionId"),new K,new O(b.ReaperSetlist,"testOutput")],[r,a,n,i]=await this.apiClient.executeCommands(e);if(i===void 0)throw new Error("Failed to retrieve testOutput. Please check the script configuration.");return i}async getProjectLength(){const t=[new z("getProjectLength"),new K,new O(b.ReaperSetlist,"projectLength")],[e,r,a]=await this.apiClient.executeCommands(t);if(a===void 0)throw new Error("Failed to retrieve projectLength. Please check the script configuration.");return parseFloat(a)}async getOpenTabs(){const t=[new z("getOpenTabs"),new K,new O(b.ReaperSetlist,"tabs"),new O(b.ReaperSetlist,"activeIndex")],[e,r,a,n]=await this.apiClient.executeCommands(t);if(a===void 0)throw new Error("Failed to retrieve tabs. Please check the script configuration.");const i=JSON.parse(a);if(n===void 0)throw new Error("Failed to retrieve activeIndex. Please check the script configuration.");const o=parseFloat(n);return{tabs:i,activeIndex:o}}async writeChunkedData(t,e,r){const a=[new N(b.ReaperSetlist,"section",t),new N(b.ReaperSetlist,"key",e),...this.getChunkCommands("chunks",r),new z("writeChunkedData"),new K];await this.apiClient.executeCommands(a)}async deleteState(t,e){const r=[new N(b.ReaperSetlist,"section",t),new N(b.ReaperSetlist,"key",e),new z("deleteState"),new K];await this.apiClient.executeCommands(r)}async exportRecordings(){const t=[new z("exportRecordings"),new K];await this.apiClient.executeCommands(t)}}class Ls{constructor(t){this.apiClient=t}async getStateValue(t){const e=new O(b.ReaperSetlist,t);return await this.apiClient.executeCommand(e)}async setStateValue(t,e){const r=new N(b.ReaperSetlist,t,e,!0);await this.apiClient.executeCommand(r)}async getProjectRoot(){return await this.getStateValue(et.ProjectRoot)}async getScriptActionId(){return await this.getStateValue(et.ScriptActionId)}async setProjectRoot(t){await this.setStateValue(et.ProjectRoot,t)}async setScriptActionId(t){await this.setStateValue(et.ScriptActionId,t)}}class js extends le{async deleteSongFromSets(t){const e=await this.list(),r=[];for(const a of Object.values(e))a.songs.includes(t)&&(a.songs=a.songs.filter(n=>n!==t),r.push(this.update(a.id,a)));await Promise.all(r)}}const Ds="/_";class Ks{constructor(t=globalThis.fetch,e=Ds){M(this,"reaper");M(this,"script");M(this,"scriptSettings");M(this,"songs");M(this,"sets");this.urlRoot=e;const r=new ks(this.urlRoot,t);this.reaper=r,this.script=new Ms(r),this.scriptSettings=new Ls(r),this.songs=new le(r,this.script,b.Songs),this.sets=new js(r,this.script,b.Sets)}}function Xt(s){return new Ks(s)}var Q;class zs{constructor(){ft(this,Q,rt(Qt({scriptActionId:void 0,folderPath:void 0,setupComplete:!1})));M(this,"initialized",!1);M(this,"initializing",!1);M(this,"initPromise",null)}get configuration(){return L(V(this,Q))}set configuration(t){U(V(this,Q),t,!0)}get data(){return this.configuration}get isSetupComplete(){return this.configuration.setupComplete}get scriptActionId(){return this.configuration.scriptActionId}get folderPath(){return this.configuration.folderPath}async initialize(t){if(!this.initialized){if(this.initializing&&this.initPromise)return this.initPromise;this.initializing=!0,this.initPromise=this._doInitialize(t);try{await this.initPromise}finally{this.initializing=!1,this.initPromise=null}}}async _doInitialize(t){try{const e=Xt(t),[r,a]=await Promise.all([e.scriptSettings.getScriptActionId(),e.scriptSettings.getProjectRoot()]);this.configuration.scriptActionId=r,this.configuration.folderPath=a,this.configuration.setupComplete=!!(a&&r),this.initialized=!0}catch(e){console.error("Error initializing configuration:",e),this.configuration.setupComplete=!1}}ensureInitialized(t){return this.initialized?Promise.resolve():this.initialize(t)}async updateFolderPath(t,e){try{await Xt(e).scriptSettings.setProjectRoot(t),this.configuration.folderPath=t;const a=!!(t&&this.configuration.scriptActionId);this.configuration.setupComplete!==a&&(this.configuration.setupComplete=a)}catch(r){throw console.error("Error updating folder path:",r),r}}updateSetupComplete(){this.configuration.setupComplete=!!(this.configuration.folderPath&&this.configuration.scriptActionId)}reset(){this.configuration.scriptActionId=void 0,this.configuration.folderPath=void 0,this.configuration.setupComplete=!1,this.initialized=!1,this.initializing=!1,this.initPromise=null}}Q=new WeakMap;const St=new zs;var Fs=ts('<svg><path fill="none" stroke="currentColor" stroke-dasharray="16" stroke-dashoffset="16" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3c4.97 0 9 4.03 9 9"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.2s" values="16;0"></animate><animateTransform attributeName="transform" dur="1.5s" repeatCount="indefinite" type="rotate" values="0 12 12;360 12 12"></animateTransform></path></svg>');function Us(s,t){const e=ss(t,["$$slots","$$events","$$legacy"]);var r=Fs();ps(r,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...e})),J(s,r)}var Bs=ee("<a><!></a>"),Vs=ee("<button><!></button>");function tr(s,t){Je(t,!0);let e=rs(t,"variant",3,"text"),r=rt(!1),a=rt(void 0);function n(y,c){if(c==="submit")return"var(--green)";switch(y){default:case"primary":return"var(--primary)";case"delete":return"var(--red)";case"edit":return"var(--yellow)";case"success":return"var(--green)"}}function i(){return e()==="text"}async function o(y){var c;y.stopPropagation(),U(r,!0),await((c=t.onclick)==null?void 0:c.call(t)),U(r,!1)}const f=Ye(()=>n(t.color,t.elementType));var m=zt(),v=Mt(m);{var S=y=>{var c=Bs();let w;var d=Lt(c);Bt(d,()=>t.children??jt),Dt(c),Ut(c,p=>U(a,p),()=>L(a)),Kt(p=>{w=_t(c,1,"button svelte-179z4bh",null,w,p),F(c,"title",t.title),yt(c,`--button-color: ${L(f)};`),F(c,"href",t.href)},[()=>({"text-button":i()})]),J(y,c)},h=y=>{var c=Vs();let w;c.__click=o;var d=Lt(c);{var p=R=>{Us(R,{})},E=R=>{var C=zt(),T=Mt(C);Bt(T,()=>t.children??jt),J(R,C)};Ft(d,R=>{L(r)?R(p):R(E,!1)})}Dt(c),Ut(c,R=>U(a,R),()=>L(a)),Kt(R=>{w=_t(c,1,"button svelte-179z4bh",null,w,R),F(c,"type",t.elementType==="submit"?"submit":"button"),yt(c,`--button-color: ${L(f)};`),F(c,"title",t.title),F(c,"aria-label",t.title),c.disabled=L(r)||t.disabled},[()=>({"text-button":i()})]),J(y,c)};Ft(v,y=>{t.elementType==="a"?y(S):y(h,!1)})}J(s,m),qe()}te(["click"]);export{tr as B,_ as C,Us as L,ps as a,Ws as b,_t as c,pt as d,Ys as e,Zs as f,Xt as g,$s as h,qs as i,yt as j,St as k,F as l,ce as m,Qs as n,cs as o,fs as r,Bt as s};
