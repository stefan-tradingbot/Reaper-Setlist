var ae=Object.defineProperty;var Tt=s=>{throw TypeError(s)};var ne=(s,t,e)=>t in s?ae(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var k=(s,t,e)=>ne(s,typeof t!="symbol"?t+"":t,e),ie=(s,t,e)=>t.has(s)||Tt("Cannot "+e);var B=(s,t,e)=>(ie(s,t,"read from private field"),e?e.call(s):t.get(s)),nt=(s,t,e)=>t.has(s)?Tt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,e);import{d as tt,l as N,ap as oe,Q as Ut,e as $,g as ce,aq as it,am as Vt,y as bt,Z as le,ar as Et,h as b,as as ue,al as fe,at as de,au as vt,av as wt,aw as he,ax as J,b as pe,a8 as Ht,K as me,M as ge,N as Pt,O as ot,P as G,i as K,ai as ve,ab as we,ac as Se,a9 as Ce,ay as Gt,G as _e,az as kt,aA as ye,E as Re,x as pt,A as St,aB as xe,aC as Te,u as be,aD as Ee,aE as Pe,X as ke,aF as Ae,aG as Ie,aH as Ne,aI as Oe,q as Z,k as qt,o as D,p as Me,f as At,a as Le,c as It,r as Nt,t as Ot,m as je}from"./CK57Ve49.js";import{l as Fe,j as Ke,k as De,d as Jt,n as ze,o as Be,p as Ue,q as Ve,b as He,a as H,g as Mt,f as Xt}from"./BzJ4SX3Z.js";import{r as Ge,p as qe,i as Lt,b as jt}from"./_0x7LJxc.js";let ct=null;function Ks(s,t){return t}function Je(s,t,e,r){for(var a=[],n=t.length,i=0;i<n;i++)ue(t[i].e,a,!0);var o=n>0&&a.length===0&&e!==null;if(o){var f=e.parentNode;fe(f),f.append(e),r.clear(),j(s,t[0].prev,t[n-1].next)}de(a,()=>{for(var d=0;d<n;d++){var g=t[d];o||(r.delete(g.k),j(s,g.prev,g.next)),J(g.e,!o)}})}function Ds(s,t,e,r,a,n=null){var i=s,o={flags:t,items:new Map,first:null},f=(t&Gt)!==0;if(f){var d=s;i=b?ot(Se(d)):d.appendChild(Ce())}b&&pe();var g=null,v=!1,l=oe(()=>{var c=e();return Ht(c)?c:c==null?[]:Vt(c)});tt(()=>{var c=N(l),m=c.length;if(v&&m===0)return;v=m===0;let w=!1;if(b){var R=me(i)===ge;R!==(m===0)&&(i=Pt(),ot(i),G(!1),w=!0)}if(b){for(var S=null,y,h=0;h<m;h++){if(K.nodeType===8&&K.data===ve){i=K,w=!0,G(!1);break}var u=c[h],p=r(u,h);y=Yt(K,o,S,null,u,p,h,a,t,e),o.items.set(p,y),S=y}m>0&&ot(Pt())}b||Xe(c,o,i,a,t,r,e),n!==null&&(m===0?g?Ut(g):g=$(()=>n(i)):g!==null&&ce(g,()=>{g=null})),w&&G(!0),N(l)}),b&&(i=K)}function Xe(s,t,e,r,a,n,i){var Ct,_t,yt,Rt;var o=(a&ye)!==0,f=(a&(wt|vt))!==0,d=s.length,g=t.items,v=t.first,l=v,c,m=null,w,R=[],S=[],y,h,u,p;if(o)for(p=0;p<d;p+=1)y=s[p],h=n(y,p),u=g.get(h),u!==void 0&&((Ct=u.a)==null||Ct.measure(),(w??(w=new Set)).add(u));for(p=0;p<d;p+=1){if(y=s[p],h=n(y,p),u=g.get(h),u===void 0){var L=l?l.e.nodes_start:e;m=Yt(L,t,m,m===null?t.first:m.next,y,h,p,r,a,i),g.set(h,m),R=[],S=[],l=m.next;continue}if(f&&Ye(u,y,p,a),(u.e.f&it)!==0&&(Ut(u.e),o&&((_t=u.a)==null||_t.unfix(),(w??(w=new Set)).delete(u))),u!==l){if(c!==void 0&&c.has(u)){if(R.length<S.length){var x=S[0],O;m=x.prev;var W=R[0],rt=R[R.length-1];for(O=0;O<R.length;O+=1)Ft(R[O],x,e);for(O=0;O<S.length;O+=1)c.delete(S[O]);j(t,W.prev,rt.next),j(t,m,W),j(t,rt,x),l=x,m=rt,p-=1,R=[],S=[]}else c.delete(u),Ft(u,l,e),j(t,u.prev,u.next),j(t,u,m===null?t.first:m.next),j(t,m,u),m=u;continue}for(R=[],S=[];l!==null&&l.k!==h;)(l.e.f&it)===0&&(c??(c=new Set)).add(l),S.push(l),l=l.next;if(l===null)continue;u=l}R.push(u),m=u,l=u.next}if(l!==null||c!==void 0){for(var z=c===void 0?[]:Vt(c);l!==null;)(l.e.f&it)===0&&z.push(l),l=l.next;var at=z.length;if(at>0){var re=(a&Gt)!==0&&d===0?e:null;if(o){for(p=0;p<at;p+=1)(yt=z[p].a)==null||yt.measure();for(p=0;p<at;p+=1)(Rt=z[p].a)==null||Rt.fix()}Je(t,z,re,g)}}o&&_e(()=>{var xt;if(w!==void 0)for(u of w)(xt=u.a)==null||xt.apply()}),bt.first=t.first&&t.first.e,bt.last=m&&m.e}function Ye(s,t,e,r){(r&wt)!==0&&kt(s.v,t),(r&vt)!==0?kt(s.i,e):s.i=e}function Yt(s,t,e,r,a,n,i,o,f,d){var g=ct,v=(f&wt)!==0,l=(f&he)===0,c=v?l?le(a,!1,!1):Et(a):a,m=(f&vt)===0?i:Et(i),w={i:m,v:c,k:n,a:null,e:null,prev:e,next:r};ct=w;try{return w.e=$(()=>o(s,c,m,d),b),w.e.prev=e&&e.e,w.e.next=r&&r.e,e===null?t.first=w:(e.next=w,e.e.next=w.e),r!==null&&(r.prev=w,r.e.prev=w.e),w}finally{ct=g}}function Ft(s,t,e){for(var r=s.next?s.next.e.nodes_start:e,a=t?t.e.nodes_start:e,n=s.e.nodes_start;n!==r;){var i=we(n);a.before(n),n=i}}function j(s,t,e){t===null?s.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}function Kt(s,t,...e){var r=s,a=pt,n;tt(()=>{a!==(a=t())&&(n&&(J(n),n=null),n=$(()=>a(r,...e)))},Re),b&&(r=K)}function $e(s,t){var e=void 0,r;tt(()=>{e!==(e=t())&&(r&&(J(r),r=null),e&&(r=$(()=>{St(()=>e(s))})))})}function $t(s){var t,e,r="";if(typeof s=="string"||typeof s=="number")r+=s;else if(typeof s=="object")if(Array.isArray(s)){var a=s.length;for(t=0;t<a;t++)s[t]&&(e=$t(s[t]))&&(r&&(r+=" "),r+=e)}else for(e in s)s[e]&&(r&&(r+=" "),r+=e);return r}function We(){for(var s,t,e=0,r="",a=arguments.length;e<a;e++)(s=arguments[e])&&(t=$t(s))&&(r&&(r+=" "),r+=t);return r}function Ze(s){return typeof s=="object"?We(s):s??""}const Dt=[...` 	
\r\fÂ \v\uFEFF`];function Qe(s,t,e){var r=s==null?"":""+s;if(t&&(r=r?r+" "+t:t),e){for(var a in e)if(e[a])r=r?r+" "+a:a;else if(r.length)for(var n=a.length,i=0;(i=r.indexOf(a,i))>=0;){var o=i+n;(i===0||Dt.includes(r[i-1]))&&(o===r.length||Dt.includes(r[o]))?r=(i===0?"":r.substring(0,i))+r.substring(o+1):i=o}}return r===""?null:r}function zt(s,t=!1){var e=t?" !important;":";",r="";for(var a in s){var n=s[a];n!=null&&n!==""&&(r+=" "+a+": "+n+e)}return r}function lt(s){return s[0]!=="-"||s[1]!=="-"?s.toLowerCase():s}function ts(s,t){if(t){var e="",r,a;if(Array.isArray(t)?(r=t[0],a=t[1]):r=t,s){s=String(s).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var n=!1,i=0,o=!1,f=[];r&&f.push(...Object.keys(r).map(lt)),a&&f.push(...Object.keys(a).map(lt));var d=0,g=-1;const w=s.length;for(var v=0;v<w;v++){var l=s[v];if(o?l==="/"&&s[v-1]==="*"&&(o=!1):n?n===l&&(n=!1):l==="/"&&s[v+1]==="*"?o=!0:l==='"'||l==="'"?n=l:l==="("?i++:l===")"&&i--,!o&&n===!1&&i===0){if(l===":"&&g===-1)g=v;else if(l===";"||v===w-1){if(g!==-1){var c=lt(s.substring(d,g).trim());if(!f.includes(c)){l!==";"&&v++;var m=s.substring(d,v).trim();e+=" "+m+";"}}d=v+1,g=-1}}}}return r&&(e+=zt(r)),a&&(e+=zt(a,!0)),e=e.trim(),e===""?null:e}return s==null?null:String(s)}function mt(s,t,e,r,a,n){var i=s.__className;if(b||i!==e||i===void 0){var o=Qe(e,r,n);(!b||o!==s.getAttribute("class"))&&(o==null?s.removeAttribute("class"):t?s.className=o:s.setAttribute("class",o)),s.__className=e}else if(n&&a!==n)for(var f in n){var d=!!n[f];(a==null||d!==!!a[f])&&s.classList.toggle(f,d)}return n}function ut(s,t={},e,r){for(var a in e){var n=e[a];t[a]!==n&&(e[a]==null?s.style.removeProperty(a):s.style.setProperty(a,n,r))}}function gt(s,t,e,r){var a=s.__style;if(b||a!==t){var n=ts(t,r);(!b||n!==s.getAttribute("style"))&&(n==null?s.removeAttribute("style"):s.style.cssText=n),s.__style=t}else r&&(Array.isArray(r)?(ut(s,e==null?void 0:e[0],r[0]),ut(s,e==null?void 0:e[1],r[1],"important")):ut(s,e,r));return r}function Q(s,t,e){if(s.multiple){if(t==null)return;if(!Ht(t))return xe();for(var r of s.options)r.selected=t.includes(q(r));return}for(r of s.options){var a=q(r);if(Te(a,t)){r.selected=!0;return}}(!e||t!==void 0)&&(s.selectedIndex=-1)}function Wt(s,t){let e=!0;St(()=>{t&&Q(s,be(t),e),e=!1;var r=new MutationObserver(()=>{var a=s.__value;Q(s,a)});return r.observe(s,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{r.disconnect()}})}function zs(s,t,e=t){var r=!0;Fe(s,"change",a=>{var n=a?"[selected]":":checked",i;if(s.multiple)i=[].map.call(s.querySelectorAll(n),q);else{var o=s.querySelector(n)??s.querySelector("option:not([disabled])");i=o&&q(o)}e(i)}),St(()=>{var a=t();if(Q(s,a,r),r&&a===void 0){var n=s.querySelector(":checked");n!==null&&(a=q(n),e(a))}s.__value=a,r=!1}),Wt(s)}function q(s){return"__value"in s?s.__value:s.value}const U=Symbol("class"),V=Symbol("style"),Zt=Symbol("is custom element"),Qt=Symbol("is html");function Bs(s){if(b){var t=!1,e=()=>{if(!t){if(t=!0,s.hasAttribute("value")){var r=s.value;M(s,"value",null),s.value=r}if(s.hasAttribute("checked")){var a=s.checked;M(s,"checked",null),s.checked=a}}};s.__on_r=e,Ie(e),Ue()}}function Us(s,t){var e=et(s);e.value===(e.value=t??void 0)||s.value===t&&(t!==0||s.nodeName!=="PROGRESS")||(s.value=t??"")}function Vs(s,t){var e=et(s);e.checked!==(e.checked=t??void 0)&&(s.checked=t)}function es(s,t){t?s.hasAttribute("selected")||s.setAttribute("selected",""):s.removeAttribute("selected")}function M(s,t,e,r){var a=et(s);b&&(a[t]=s.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&s.nodeName==="LINK")||a[t]!==(a[t]=e)&&(t==="loading"&&(s[Ne]=e),e==null?s.removeAttribute(t):typeof e!="string"&&te(s).includes(t)?s[t]=e:s.setAttribute(t,e))}function ss(s,t,e,r,a=!1){var n=et(s),i=n[Zt],o=!n[Qt];let f=b&&i;f&&G(!1);var d=t||{},g=s.tagName==="OPTION";for(var v in t)v in e||(e[v]=null);e.class?e.class=Ze(e.class):e[U]&&(e.class=null),e[V]&&(e.style??(e.style=null));var l=te(s);for(const h in e){let u=e[h];if(g&&h==="value"&&u==null){s.value=s.__value="",d[h]=u;continue}if(h==="class"){var c=s.namespaceURI==="http://www.w3.org/1999/xhtml";mt(s,c,u,r,t==null?void 0:t[U],e[U]),d[h]=u,d[U]=e[U];continue}if(h==="style"){gt(s,u,t==null?void 0:t[V],e[V]),d[h]=u,d[V]=e[V];continue}var m=d[h];if(u!==m){d[h]=u;var w=h[0]+h[1];if(w!=="$$")if(w==="on"){const p={},L="$$"+h;let x=h.slice(2);var R=Ve(x);if(Ke(x)&&(x=x.slice(0,-7),p.capture=!0),!R&&m){if(u!=null)continue;s.removeEventListener(x,d[L],p),d[L]=null}if(u!=null)if(R)s[`__${x}`]=u,Jt([x]);else{let O=function(W){d[h].call(this,W)};d[L]=De(x,s,O,p)}else R&&(s[`__${x}`]=void 0)}else if(h==="style")M(s,h,u);else if(h==="autofocus")ze(s,!!u);else if(!i&&(h==="__value"||h==="value"&&u!=null))s.value=s.__value=u;else if(h==="selected"&&g)es(s,u);else{var S=h;o||(S=Be(S));var y=S==="defaultValue"||S==="defaultChecked";if(u==null&&!i&&!y)if(n[h]=null,S==="value"||S==="checked"){let p=s;const L=t===void 0;if(S==="value"){let x=p.defaultValue;p.removeAttribute(S),p.defaultValue=x,p.value=p.__value=L?x:null}else{let x=p.defaultChecked;p.removeAttribute(S),p.defaultChecked=x,p.checked=L?x:!1}}else s.removeAttribute(h);else y||l.includes(S)&&(i||typeof u!="string")?s[S]=u:typeof u!="function"&&M(s,S,u)}}}return f&&G(!0),d}function rs(s,t,e=[],r,a=!1,n=ke){const i=e.map(n);var o=void 0,f={},d=s.nodeName==="SELECT",g=!1;tt(()=>{var v=t(...i.map(N));ss(s,o,v,r,a),g&&d&&"value"in v&&Q(s,v.value,!1);for(let c of Object.getOwnPropertySymbols(f))v[c]||J(f[c]);for(let c of Object.getOwnPropertySymbols(v)){var l=v[c];c.description===Ae&&(!o||l!==o[c])&&(f[c]&&J(f[c]),f[c]=$(()=>$e(s,()=>l)))}o=v}),d&&Wt(s,()=>o.value),g=!0}function et(s){return s.__attributes??(s.__attributes={[Zt]:s.nodeName.includes("-"),[Qt]:s.namespaceURI===Ee})}var Bt=new Map;function te(s){var t=Bt.get(s.nodeName);if(t)return t;Bt.set(s.nodeName,t=[]);for(var e,r=s,a=Element.prototype;a!==r;){e=Oe(r);for(var n in e)e[n].set&&t.push(n);r=Pe(r)}return t}function Hs(s){const t=Math.floor(s/60),e=Math.floor(s%60);return`${t}:${e.toString().padStart(2,"0")}`}function ee(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const t=Math.random()*16|0;return(s==="x"?t:t&3|8).toString(16)})}var X;class as{constructor(){nt(this,X,Z(qt([])))}get notifications(){return N(B(this,X))}set notifications(t){D(B(this,X),t,!0)}get items(){return this.notifications}add(t,e="primary",r){const a=ee(),n={id:a,message:t,type:e,duration:r,timestamp:new Date};return this.notifications=[...this.notifications,n],r!==void 0&&setTimeout(()=>{this.remove(a)},r),a}remove(t){this.notifications=this.notifications.filter(e=>e.id!==t)}clear(){this.notifications=[]}success(t,e=5e3){return this.add(t,"success",e)}error(t,e){return this.add(t,"delete",e)}warning(t,e=7e3){return this.add(t,"edit",e)}info(t,e=5e3){return this.add(t,"primary",e)}}X=new WeakMap;const Gs=new as,ns="Operation",F={ProjectRoot:"ProjectRoot",ScriptActionId:"ScriptActionId",ExportPath:"ExportPath"},_={ReaperSetlist:"ReaperSetlist",Songs:"ReaperSetlist.Songs",Sets:"ReaperSetlist.Sets"};class st{}class is extends st{parseResponse(t){if(!t)throw new Error("Empty transport response");const e=t.split("	");if(e.length!==6)throw new Error(`Unexpected transport format: ${t}`);return{playState:parseInt(e[1],10),positionSeconds:parseFloat(e[2]),repeatOn:e[3]==="1",positionString:e[4],positionStringBeats:e[5]}}getResponseMarker(){return"TRANSPORT"}async getCommandString(){return Promise.resolve("TRANSPORT")}}class os extends st{parseResponse(t){const e=[];for(const r of t){if(r.startsWith("MARKER_LIST"))continue;if(r.startsWith("MARKER_LIST_END"))break;const a=r.split("	");if(a.length<4)throw new Error(`Invalid marker line: ${r}`);const n={id:parseInt(a[2],10),name:a[1],position:parseFloat(a[3])};e.push(n)}return e}getResponseMarker(){return"MARKER_LIST"}async getCommandString(){return Promise.resolve("MARKER")}}class P extends st{parseResponse(t){}getResponseMarker(){}}class cs extends P{getCommandString(){return Promise.resolve("40042")}}class ls extends P{getCommandString(){return Promise.resolve("40859")}}class us extends P{getCommandString(){return Promise.resolve("40860")}}class fs extends P{getCommandString(){return Promise.resolve("40886")}}class ds extends P{getCommandString(){return Promise.resolve("40861")}}class hs extends P{getCommandString(){return Promise.resolve("40862")}}class ps extends P{getCommandString(){return Promise.resolve("1007")}}class ms extends P{getCommandString(){return Promise.resolve("1008")}}class gs extends P{getCommandString(){return Promise.resolve("1016")}}class vs extends P{getCommandString(){return Promise.resolve("1013")}}class A extends P{async getCommandString(){if(await ht.ensureInitialized(),!ht.scriptActionId)throw new Error("Script action ID is not set. Please configure it in the settings.");return ht.scriptActionId}}class ws extends P{constructor(t){super(),this.markerId=t}async getCommandString(){return Promise.resolve(`SET/POS_STR/m${this.markerId}`)}}class T extends P{constructor(t,e,r,a=!1){super(),this.section=t,this.key=e,this.value=r,this.persist=a}async getCommandString(){const t=this.persist?"SET/EXTSTATEPERSIST":"SET/EXTSTATE",e=encodeURIComponent(this.value);return Promise.resolve(`${t}/${this.section}/${this.key}/${e}`)}}class I extends T{constructor(t){super(_.ReaperSetlist,ns,t,!1)}}class E extends st{constructor(t,e,r=!0){super(),this.section=t,this.key=e,this.temp=r}getCommandString(){const t=this.temp?"GET/EXTSTATE":"GET/EXTSTATE_PERSIST";return Promise.resolve(`${t}/${this.section}/${this.key}`)}parseResponse(t){if(!t||t.trim()==="")return;const e=t.trim(),r=e.split("	");if(r.length===4&&r[0]==="EXTSTATE"&&r[1]===this.section&&r[2]===this.key)return r[3];if(r.length===3&&r[0]==="EXTSTATE"&&r[1]===this.section&&r[2]===this.key)return;throw new Error(`Unexpected response format: ${e}`)}getResponseMarker(){return"EXTSTATE"}}const C={transport:()=>new is,markers:()=>new os,goToStart:()=>new cs,goToMarker:s=>new ws(s),newTab:()=>new ls,closeTab:()=>new us,closeAllTabs:()=>new fs,nextTab:()=>new ds,previousTab:()=>new hs,play:()=>new ps,pause:()=>new ms,stop:()=>new gs,record:()=>new vs},Ss=600;class Cs{constructor(t,e=globalThis.fetch){k(this,"urlRoot");k(this,"fetch");this.urlRoot=t,this.fetch=e}async executeCommand(t){const[e]=await this.executeCommands([t]);return e}async executeCommands(t){const e=await Promise.all(t.map(n=>n.getCommandString())),r=await this.sendRawCommands(e);return this.parseMultiCommandResponse(t,r)}parseMultiCommandResponse(t,e){const r=[];let a=0;for(const n of t){if(!n.getResponseMarker()){r.push(void 0);continue}const i=e[a];if(i.length===0)throw new Error(`Empty response for command: ${n.getCommandString()}`);const o=i.split("	")[0];if(o!==n.getResponseMarker())throw new Error(`Unexpected response type for command ${n.getCommandString()}: expected ${n.getResponseMarker()}, got ${o}`);if(n.getResponseMarker()==="MARKER_LIST"){const f=n.parseResponse(e.slice(a)),d=f;r.push(f),a+=d.length+1}else{const f=n.parseResponse(i);r.push(f)}a++}return r}async sendCommand(t){return this.sendRawCommand(t)}async sendCommands(t){return this.sendRawCommands(t)}async getTransport(){return this.executeCommand(C.transport())}async goToStart(){const[t,e]=await this.executeCommands([C.goToStart(),C.transport()]);return e}async play(){const[,t]=await this.executeCommands([C.play(),C.transport()]);return t}async pause(){const[,t]=await this.executeCommands([C.pause(),C.transport()]);return t}async stop(){const[,t]=await this.executeCommands([C.stop(),C.transport()]);return t}async record(){const[,t]=await this.executeCommands([C.record(),C.transport()]);return t}async closeTab(){await this.executeCommand(C.closeTab())}async newTab(){await this.executeCommand(C.newTab())}async closeAllTabs(){await this.executeCommand(C.closeAllTabs())}async nextTab(){const[,t,e]=await this.executeCommands([C.nextTab(),C.transport(),C.markers()]);return{markers:e,transport:t}}async previousTab(){const[,t,e]=await this.executeCommands([C.previousTab(),C.transport(),C.markers()]);return{markers:e,transport:t}}async getMarkers(){return this.executeCommand(C.markers())}async goToMarker(t){const[e,r]=await this.executeCommands([C.goToMarker(t),C.transport()]);return r}async playAndGetFullState(){const[t,e,r]=await this.executeCommands([C.play(),C.transport(),C.markers()]);return{playResult:t,transport:e,markers:r}}async sendRawCommand(t){const e=await this.fetch(`${this.urlRoot}/${t}`,{method:"GET"});if(!e.ok)throw new Error(`Failed to send command ${t}: ${e.statusText}`);return(await e.text()).split(`
`).filter(n=>n.trim()!=="")}async sendRawCommands(t){if(t.length===0)return[];const e=[],r=this.batchCommandsByUrlLength(t);for(const a of r){const n=`${this.urlRoot}/${a.join(";")}`,i=await this.fetch(n,{method:"GET"});if(!i.ok)throw new Error(`Failed to send commands ${a.join(",")}: ${i.statusText}`);const f=(await i.text()).split(`
`).slice(0,-1);e.push(...f)}return e}batchCommandsByUrlLength(t){const e=[];let r=[],a=this.urlRoot.length;for(const n of t){const o=(r.length>0?";":"").length+n.length;a+o>Ss&&r.length>0?(e.push([...r]),r=[n],a=this.urlRoot.length+n.length):(r.push(n),a+=o)}return r.length>0&&e.push(r),e}}class _s{}const ys=500,ft="__index__";class se extends _s{constructor(t,e,r){super(),this.apiClient=t,this.scriptClient=e,this.sectionKey=r}async fetchIndex(){const t=new E(this.sectionKey,ft),e=await this.apiClient.executeCommand(t);return e?JSON.parse(e):[]}async saveData(t,e){JSON.stringify(e).length<=ys?await this.apiClient.executeCommand(new T(this.sectionKey,t,JSON.stringify(e),!0)):await this.scriptClient.writeChunkedData(this.sectionKey,t,e)}async saveIndex(t){await this.saveData(ft,t)}async fetchById(t){const e=new E(this.sectionKey,t),r=await this.apiClient.executeCommand(e);return r?JSON.parse(r):void 0}async saveById(t,e){await this.saveData(t,e)}async deleteById(t){await this.scriptClient.deleteState(this.sectionKey,t)}async get(t){return this.fetchById(t)}async update(t,e){await this.saveById(t,e)}async add(t){const e=ee(),r={...t,id:e};await this.saveById(e,r);const a=await this.fetchIndex();return a.push(e),await this.saveIndex(a),r}async delete(t){await this.deleteById(t);const r=(await this.fetchIndex()).filter(a=>a!==t);await this.saveIndex(r)}async list(){const t=new E(this.sectionKey,ft),e=await this.apiClient.executeCommand(t);if(!e)return{};const r=JSON.parse(e),a={},n=r.map(o=>new E(this.sectionKey,o)),i=await this.apiClient.executeCommands(n);for(const o of i)if(o){const f=JSON.parse(o);a[f.id]=f}return a}}class Rs{constructor(t){this.apiClient=t}getChunkCommands(t,e){const r=[],a=JSON.stringify(e),n=500;for(let o=0;o<a.length;o+=n)r.push(a.slice(o,o+n));const i=[];i.push(new T(_.ReaperSetlist,`${t}_length`,r.length.toString()));for(let o=0;o<r.length;o++)i.push(new T(_.ReaperSetlist,`${t}_${o}`,r[o]));return i}async listProjects(){const t=[new I("listProjects"),new A,new E(_.ReaperSetlist,"projects")],[e,r,a]=await this.apiClient.executeCommands(t);if(a===void 0)throw new Error("Failed to retrieve projects. Please check the script configuration.");return JSON.parse(a)}async testProjectsFolder(t){const e=[new T(_.ReaperSetlist,"folderPath",t),new I("testProjectsFolder"),new A,new E(_.ReaperSetlist,"valid"),new E(_.ReaperSetlist,"message")],[r,a,n,i,o]=await this.apiClient.executeCommands(e);if(i===void 0)throw new Error("Failed to retrieve valid. Please check the script configuration.");const f=i==="true";if(o===void 0)throw new Error("Failed to retrieve message. Please check the script configuration.");return{valid:f,message:o}}async openProject(t){const e=[new T(_.ReaperSetlist,"projectPath",t),new I("openProject"),new A];await this.apiClient.executeCommands(e)}async testActionId(t){const e=[new T(_.ReaperSetlist,"testNonce",t),new I("testActionId"),new A,new E(_.ReaperSetlist,"testOutput")],[r,a,n,i]=await this.apiClient.executeCommands(e);if(i===void 0)throw new Error("Failed to retrieve testOutput. Please check the script configuration.");return i}async getProjectLength(){const t=[new I("getProjectLength"),new A,new E(_.ReaperSetlist,"projectLength")],[e,r,a]=await this.apiClient.executeCommands(t);if(a===void 0)throw new Error("Failed to retrieve projectLength. Please check the script configuration.");return parseFloat(a)}async getOpenTabs(){const t=[new I("getOpenTabs"),new A,new E(_.ReaperSetlist,"tabs"),new E(_.ReaperSetlist,"activeIndex")],[e,r,a,n]=await this.apiClient.executeCommands(t);if(a===void 0)throw new Error("Failed to retrieve tabs. Please check the script configuration.");const i=JSON.parse(a);if(n===void 0)throw new Error("Failed to retrieve activeIndex. Please check the script configuration.");const o=parseFloat(n);return{tabs:i,activeIndex:o}}async writeChunkedData(t,e,r){const a=[new T(_.ReaperSetlist,"section",t),new T(_.ReaperSetlist,"key",e),...this.getChunkCommands("chunks",r),new I("writeChunkedData"),new A];await this.apiClient.executeCommands(a)}async deleteState(t,e){const r=[new T(_.ReaperSetlist,"section",t),new T(_.ReaperSetlist,"key",e),new I("deleteState"),new A];await this.apiClient.executeCommands(r)}async getTrackNames(){const t=[new I("getTrackNames"),new A,new E(_.ReaperSetlist,"trackNames")],[e,r,a]=await this.apiClient.executeCommands(t);if(a===void 0)throw new Error("Failed to retrieve trackNames. Please check the script configuration.");return JSON.parse(a)}async browseFolder(t){const e=[new T(_.ReaperSetlist,"initialPath",t),new I("browseFolder"),new A,new E(_.ReaperSetlist,"path")],[r,a,n,i]=await this.apiClient.executeCommands(e);if(i===void 0)throw new Error("Failed to retrieve path. Please check the script configuration.");return i}async exportRecordings(t,e){const r=[new T(_.ReaperSetlist,"trackNames",JSON.stringify(t)),new T(_.ReaperSetlist,"exportPath",e),new I("exportRecordings"),new A];await this.apiClient.executeCommands(r)}}class xs{constructor(t){this.apiClient=t}async getStateValue(t){const e=new E(_.ReaperSetlist,t);return await this.apiClient.executeCommand(e)}async setStateValue(t,e){const r=new T(_.ReaperSetlist,t,e,!0);await this.apiClient.executeCommand(r)}async getProjectRoot(){return await this.getStateValue(F.ProjectRoot)}async getScriptActionId(){return await this.getStateValue(F.ScriptActionId)}async setProjectRoot(t){await this.setStateValue(F.ProjectRoot,t)}async setScriptActionId(t){await this.setStateValue(F.ScriptActionId,t)}async getExportPath(){return await this.getStateValue(F.ExportPath)}async setExportPath(t){await this.setStateValue(F.ExportPath,t)}}class Ts extends se{async deleteSongFromSets(t){const e=await this.list(),r=[];for(const a of Object.values(e))a.songs.includes(t)&&(a.songs=a.songs.filter(n=>n!==t),r.push(this.update(a.id,a)));await Promise.all(r)}}const bs="/_";class Es{constructor(t=globalThis.fetch,e=bs){k(this,"reaper");k(this,"script");k(this,"scriptSettings");k(this,"songs");k(this,"sets");this.urlRoot=e;const r=new Cs(this.urlRoot,t);this.reaper=r,this.script=new Rs(r),this.scriptSettings=new xs(r),this.songs=new se(r,this.script,_.Songs),this.sets=new Ts(r,this.script,_.Sets)}}function dt(s){return new Es(s)}var Y;class Ps{constructor(){nt(this,Y,Z(qt({scriptActionId:void 0,folderPath:void 0,exportPath:void 0,setupComplete:!1})));k(this,"initialized",!1);k(this,"initializing",!1);k(this,"initPromise",null)}get configuration(){return N(B(this,Y))}set configuration(t){D(B(this,Y),t,!0)}get data(){return this.configuration}get isSetupComplete(){return this.configuration.setupComplete}get scriptActionId(){return this.configuration.scriptActionId}get folderPath(){return this.configuration.folderPath}get exportPath(){return this.configuration.exportPath}async initialize(t){if(!this.initialized){if(this.initializing&&this.initPromise)return this.initPromise;this.initializing=!0,this.initPromise=this._doInitialize(t);try{await this.initPromise}finally{this.initializing=!1,this.initPromise=null}}}async _doInitialize(t){try{const e=dt(t),[r,a,n]=await Promise.all([e.scriptSettings.getScriptActionId(),e.scriptSettings.getProjectRoot(),e.scriptSettings.getExportPath()]);this.configuration.scriptActionId=r,this.configuration.folderPath=a,this.configuration.exportPath=n,this.configuration.setupComplete=!!(a&&r),this.initialized=!0}catch(e){console.error("Error initializing configuration:",e),this.configuration.setupComplete=!1}}ensureInitialized(t){return this.initialized?Promise.resolve():this.initialize(t)}async updateFolderPath(t,e){try{await dt(e).scriptSettings.setProjectRoot(t),this.configuration.folderPath=t;const a=!!(t&&this.configuration.scriptActionId);this.configuration.setupComplete!==a&&(this.configuration.setupComplete=a)}catch(r){throw console.error("Error updating folder path:",r),r}}async updateExportPath(t,e){try{await dt(e).scriptSettings.setExportPath(t),this.configuration.exportPath=t}catch(r){throw console.error("Error updating export path:",r),r}}updateSetupComplete(){this.configuration.setupComplete=!!(this.configuration.folderPath&&this.configuration.scriptActionId)}reset(){this.configuration.scriptActionId=void 0,this.configuration.folderPath=void 0,this.configuration.exportPath=void 0,this.configuration.setupComplete=!1,this.initialized=!1,this.initializing=!1,this.initPromise=null}}Y=new WeakMap;const ht=new Ps;var ks=He('<svg><path fill="none" stroke="currentColor" stroke-dasharray="16" stroke-dashoffset="16" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3c4.97 0 9 4.03 9 9"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.2s" values="16;0"></animate><animateTransform attributeName="transform" dur="1.5s" repeatCount="indefinite" type="rotate" values="0 12 12;360 12 12"></animateTransform></path></svg>');function As(s,t){const e=Ge(t,["$$slots","$$events","$$legacy"]);var r=ks();rs(r,()=>({class:"icon",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",...e})),H(s,r)}async function Is(s,t,e){var r;s.stopPropagation(),D(t,!0),await((r=e.onclick)==null?void 0:r.call(e)),D(t,!1)}var Ns=Xt("<a><!></a>"),Os=Xt("<button><!></button>");function qs(s,t){Me(t,!0);let e=qe(t,"variant",3,"text"),r=Z(!1),a=Z(void 0);function n(l,c){if(c==="submit")return"var(--green)";switch(l){default:case"primary":return"var(--primary)";case"delete":return"var(--red)";case"edit":return"var(--yellow)";case"success":return"var(--green)"}}function i(){return e()==="text"}const o=je(()=>n(t.color,t.elementType));var f=Mt(),d=At(f);{var g=l=>{var c=Ns();let m;var w=It(c);Kt(w,()=>t.children??pt),Nt(c),jt(c,R=>D(a,R),()=>N(a)),Ot(R=>{m=mt(c,1,"button svelte-1xb48l9",null,m,R),M(c,"title",t.title),gt(c,`--button-color: ${N(o)};`),M(c,"href",t.href)},[()=>({"text-button":i()})]),H(l,c)},v=l=>{var c=Os();let m;c.__click=[Is,r,t];var w=It(c);{var R=y=>{As(y,{})},S=y=>{var h=Mt(),u=At(h);Kt(u,()=>t.children??pt),H(y,h)};Lt(w,y=>{N(r)?y(R):y(S,!1)})}Nt(c),jt(c,y=>D(a,y),()=>N(a)),Ot(y=>{m=mt(c,1,"button svelte-1xb48l9",null,m,y),M(c,"type",t.elementType==="submit"?"submit":"button"),gt(c,`--button-color: ${N(o)};`),M(c,"title",t.title),M(c,"aria-label",t.title),c.disabled=N(r)||t.disabled},[()=>({"text-button":i()})]),H(l,c)};Lt(d,l=>{t.elementType==="a"?l(g):l(v,!1)})}H(s,f),Le()}Jt(["click"]);export{qs as B,C,As as L,rs as a,zs as b,mt as c,ct as d,Ds as e,Hs as f,dt as g,Us as h,Ks as i,gt as j,ht as k,M as l,ee as m,Gs as n,Ze as o,Vs as p,Bs as r,Kt as s};
